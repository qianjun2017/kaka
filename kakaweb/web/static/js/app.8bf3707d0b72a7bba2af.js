webpackJsonp([1],{"+1Ij":function(e,t){},CGYC:function(e,t){},FRYC:function(e,t){},GEJr:function(e,t){},Lzv7:function(e,t){},NHnr:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=a("7+uW"),i={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",{attrs:{id:"app"}},[t("transition",{attrs:{name:"fade",mode:"out-in"}},[t("router-view")],1)],1)},staticRenderFns:[]};var r=a("VU/8")({name:"App"},i,!1,function(e){a("d0mW")},null,null).exports,o=a("/ocq"),l={data:()=>({logining:!1,user:{userName:"",password:""},rules:{userName:[{required:!0,message:"请输入用户名",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"}]}}),methods:{reset(){this.$refs.loginForm.resetFields()},login(e){this.$refs.loginForm.validate(e=>{if(e){this.logining=!0;let e={userName:this.$util.encrypt(this.user.userName,this.$store.getters.getKey),password:this.$util.encrypt(this.user.password,this.$store.getters.getKey)};this.$ajax.post("/login",e).then(e=>{this.logining=!1,e.success&&(this.$store.commit("login"),Promise.all([this.$ajax.get("/currUser").then(e=>{if(!e.success)return Promise.reject(-1);this.$store.commit("setUser",e.data)}),this.$ajax.get("/currUserPermission").then(e=>{if(!e.success)return Promise.reject(-2);this.$store.commit("setPermissions",e.data)})]).then(e=>{this.$router.push({path:"/admin"})}).catch(function(){this.$store.commit("logout")}))})}})}},created(){this.$ajax.get("/key").then(e=>{if(e.success){let t=this.$util.random(8);this.$ajax.post("/key",{key:this.$util.rsaEncrypt(t,e.data)}).then(e=>{e.success&&this.$store.commit("setKey",t)})}})}},n={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("section",[e._m(0),e._v(" "),a("div",{staticClass:"middle"},[a("div",{staticClass:"login-container"},[e._m(1),e._v(" "),a("el-form",{ref:"loginForm",staticClass:"login-form",attrs:{model:e.user,rules:e.rules,"label-position":"left","label-width":"0px"}},[a("el-form-item",{staticClass:"field",attrs:{prop:"userName"}},[a("el-input",{staticClass:"field-input",attrs:{type:"text","auto-complete":"off",placeholder:"用户名"},model:{value:e.user.userName,callback:function(t){e.$set(e.user,"userName",t)},expression:"user.userName"}},[a("template",{slot:"prepend"},[a("label",{staticClass:"field-lable"})])],2)],1),e._v(" "),a("el-form-item",{staticClass:"field",attrs:{prop:"password"}},[a("el-input",{staticClass:"field-input",attrs:{type:"password","auto-complete":"off",placeholder:"密  码"},model:{value:e.user.password,callback:function(t){e.$set(e.user,"password",t)},expression:"user.password"}},[a("template",{slot:"prepend"},[a("label",{staticClass:"field-lable password-lable"})])],2)],1),e._v(" "),a("el-form-item",{staticClass:"field submit-field"},[a("el-button",{attrs:{type:"danger",loading:e.logining},nativeOn:{click:function(t){return t.preventDefault(),e.login(t)}}},[e._v("登    录")])],1)],1),e._v(" "),a("div",{staticClass:"coagent"})],1)])])},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"top"},[t("img",{staticClass:"logo",attrs:{src:"/static/logo.png"}}),t("b")])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"login-tabs"},[t("div",{staticClass:"login-tab"},[t("div",{staticClass:"login-tab-r"},[this._v("账号登录")])])])}]};var m=a("VU/8")(l,n,!1,function(e){a("GEJr")},null,null).exports,d={data:()=>({sysName:"助销小工具",collapsed:!1,asideWidth:"230px"}),methods:{handleOpen(e,t){},handleClose(e,t){},handleSelect(e,t){},collapse:function(){this.collapsed=!this.collapsed,this.collapsed?this.asideWidth="60px":this.asideWidth="230px"},logout:function(){this.$confirm("确认退出吗？","提示",{}).then(()=>{this.$ajax.post("/logout").then(e=>{e.success&&(this.$store.commit("logout"),this.$router.push({path:"/login"}))})})},setting:function(){this.$router.push("/system/setting")}},computed:{sysUserName:function(){return this.$store.getters.getUser.nickName},sysUserAvatar:function(){let e=this.$store.getters.getUser.imageUrl;return null!=e&&""!=e&&void 0!=e||(e="/static/user.png"),e}}},c={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-container",{staticClass:"container"},[a("el-header",{staticClass:"header"},[a("div",{staticClass:"logo",class:"logo-width"},[a("span",[e._v(e._s(e.sysName))])]),e._v(" "),a("div",{staticClass:"tools"},[a("i",{staticClass:"fa fa-align-justify",on:{click:e.collapse}})]),e._v(" "),a("div",{staticClass:"userinfo"},[a("el-dropdown",[a("span",{staticClass:"el-dropdown-link userinfo-inner"},[a("img",{attrs:{src:e.sysUserAvatar}}),e._v(e._s(e.sysUserName))]),e._v(" "),a("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[a("el-dropdown-item",{directives:[{name:"hasPermission",rawName:"v-hasPermission",value:"system.setting",expression:"'system.setting'"}],nativeOn:{click:function(t){return e.setting(t)}}},[e._v("个人设置")]),e._v(" "),a("el-dropdown-item",{attrs:{divided:""},nativeOn:{click:function(t){return e.logout(t)}}},[e._v("退出登录")])],1)],1)],1)]),e._v(" "),a("el-container",{staticClass:"main"},[a("el-aside",{staticClass:"asider",attrs:{width:e.asideWidth}},[a("el-menu",{staticClass:"el-menu-vertical-demo",attrs:{"default-active":"$route.path","unique-opened":"",router:"",collapse:e.collapsed},on:{open:e.handleOpen,close:e.handleClose,select:e.handleSelect}},[e._l(e.$router.options.routes,function(t,s){return[t.meta.isMenu?[t.meta.isLeaf?a("el-menu-item",{directives:[{name:"hasPermission",rawName:"v-hasPermission",value:t.meta.permission,expression:"item.meta.permission"}],key:s,attrs:{index:t.path}},[e._v(e._s(t.meta.title))]):a("el-submenu",{directives:[{name:"hasPermission",rawName:"v-hasPermission",value:t.meta.permission,expression:"item.meta.permission"}],key:s,attrs:{index:t.path}},[a("template",{slot:"title"},[e._v(e._s(t.meta.title))]),e._v(" "),e._l(t.children,function(t,s){return[t.meta.isMenu?a("el-menu-item",{directives:[{name:"hasPermission",rawName:"v-hasPermission",value:t.meta.permission,expression:"child.meta.permission"}],key:s,attrs:{index:t.path}},[e._v(e._s(t.meta.title))]):e._e()]})],2)]:e._e()]})],2)],1),e._v(" "),a("el-main",{staticClass:"content-container"},[a("el-col",{staticClass:"breadcrumb-container",attrs:{span:24}},[a("strong",{staticClass:"title"},[e._v(e._s(e.$route.meta.title))])]),e._v(" "),a("el-col",{staticClass:"content-wrapper",attrs:{span:24}},[a("transition",{attrs:{name:"fade",mode:"out-in"}},[a("div",[a("keep-alive",[e.$route.meta.keepAlive?a("router-view"):e._e()],1),e._v(" "),void 0==e.$route.meta.keepAlive?a("router-view"):e._e()],1)])],1)],1)],1)],1)},staticRenderFns:[]};var u=a("VU/8")(d,c,!1,function(e){a("cyca")},"data-v-4e85bc82",null).exports,p={render:function(){var e=this.$createElement,t=this._self._c||e;return t("section",[t("div",{staticClass:"expired"},[t("span",[this._v("您的会话已过期["),t("el-button",{attrs:{type:"text"},on:{click:this.toLogin}},[this._v("重新登录")]),this._v("]")],1)])])},staticRenderFns:[]};var h=a("VU/8")({methods:{toLogin:function(){this.$router.push({path:"/login"})}}},p,!1,function(e){a("NTCn")},"data-v-2e87b350",null).exports,g={render:function(){var e=this.$createElement,t=this._self._c||e;return t("section",[t("div",{staticClass:"unauth"},[t("span",[this._v("对不起，您无权访问["),t("el-button",{attrs:{type:"text"},on:{click:this.back}},[this._v("返回")]),this._v("]")],1)])])},staticRenderFns:[]};var v=a("VU/8")({methods:{back:function(){this.$router.go(-1)}}},g,!1,function(e){a("kH9v")},"data-v-6802aacb",null).exports,f={data:()=>({welcome:""}),methods:{},created(){this.$ajax.get("/index").then(e=>{e.success?this.welcome=e.data||"欢迎使用":this.$message.error(e.message)})}},b={render:function(){var e=this.$createElement,t=this._self._c||e;return t("section",[t("div",{staticClass:"welcome"},[this._v(this._s(this.welcome))])])},staticRenderFns:[]};var y=a("VU/8")(f,b,!1,function(e){a("dSTW")},"data-v-d3f63ba2",null).exports,_={data:()=>({queryForm:{userName:"",nickName:"",realName:"",phone:""},tableData:[],total:0,pages:0,page:1,pageSize:8,sort:"createTime",order:"desc",message:"",listLoading:!1,editFormVisible:!1,editLoading:!1,editFormRules:{userName:[{required:!0,message:"请输入用户名",trigger:"blur"}]},editForm:{id:0,userName:"",password:"",nickName:"",realName:"",phone:"",orgId:""},addFormVisible:!1,addLoading:!1,addFormRules:{userName:[{required:!0,message:"请输入用户名",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"}]},addForm:{userName:"",password:"",nickName:"",realName:"",phone:"",orgId:""},authorizeFormVisible:!1,authorizeLoading:!1,authorizeForm:{userId:0,checkedRoles:[],userName:"",isIndeterminate:!0,roles:[],checkAll:!1}}),methods:{handleCurrentChange(e){this.page=e,this.getTableData()},getTableData(){var e=this;let t={userName:e.queryForm.userName,nickName:e.queryForm.nickName,phone:e.queryForm.phone,page:e.page,pageSize:e.pageSize,sort:e.sort,order:e.order};e.listLoading=!0,e.$ajax.get("/system/user/page",t).then(t=>{e.listLoading=!1,t.success?(e.page=t.page,e.pageSize=t.pageSize,e.total=t.total,e.pages=t.pages,e.tableData=t.data):(e.tableData=[],e.page=0,e.total=0,e.pages=0,e.message=t.message)})},handleDel:function(e,t){var a=this;a.$confirm("确认删除该记录吗?","提示",{type:"warning"}).then(()=>{a.listLoading=!0,a.$ajax.post("/system/user/delete/"+t.id).then(e=>{a.listLoading=!1,e.success&&(a.$message({message:"删除成功",type:"success"}),a.getTableData())})}).catch(()=>{})},handleEdit:function(e,t){this.editFormVisible=!0,this.editForm=Object.assign({},t)},handleAdd:function(){this.addFormVisible=!0,this.addForm={userName:"",password:"",nickName:"",realName:"",phone:""}},editSubmit:function(){var e=this;e.$refs.editForm.validate(t=>{t&&e.$confirm("确认提交吗？","提示",{}).then(()=>{e.editLoading=!0;let t=Object.assign({},e.editForm);e.$ajax.post("/system/user/update",t).then(t=>{e.editLoading=!1,t.success&&(e.$message({message:"提交成功",type:"success"}),e.$refs.editForm.resetFields(),e.editFormVisible=!1,e.getTableData())})})})},addSubmit:function(){var e=this;e.$refs.addForm.validate(t=>{t&&e.$confirm("确认提交吗？","提示",{}).then(()=>{e.addLoading=!0;let t=Object.assign({},e.addForm);e.$ajax.post("/system/user/add",t).then(t=>{e.addLoading=!1,t.success&&(e.$message({message:"提交成功",type:"success"}),e.$refs.addForm.resetFields(),e.addFormVisible=!1,e.getTableData())})})})},sortChanged:function(e){this.sort=e.prop,this.order="ascending"===e.order?"asc":"desc",this.getTableData()},authorize:function(e,t){this.authorizeForm.userId=t.id,this.authorizeForm.userName=t.nickName;var a=this;Promise.all([a.$ajax.get("/system/user/"+t.id+"/roles/").then(function(e){return e.success?(a.authorizeForm.checkedRoles=e.data,Promise.resolve(0)):Promise.reject(-1)}),a.$ajax.get("/system/role/all").then(function(e){return e.success?(a.authorizeForm.roles=e.data,Promise.resolve(0)):Promise.reject(-2)})]).then(function(){a.authorizeForm.checkAll=a.authorizeForm.roles.length===a.authorizeForm.checkedRoles.length,a.authorizeForm.isIndeterminate=a.authorizeForm.checkedRoles.length>0&&a.authorizeForm.checkedRoles.length<a.authorizeForm.roles.length,a.authorizeFormVisible=!0},function(e){-2==e?a.$message.info("请先配置系统角色"):a.$message.error("系统错误")})},handleCheckAllChange(e){if(this.authorizeForm.checkedRoles=[],e){var t=this;this.authorizeForm.roles.forEach(e=>{t.authorizeForm.checkedRoles.push(e.id)})}this.authorizeForm.isIndeterminate=!1},handleCheckedRolesChange(e){let t=e.length;this.authorizeForm.checkAll=t===this.authorizeForm.roles.length,this.authorizeForm.isIndeterminate=t>0&&t<this.authorizeForm.roles.length},authorizeSubmit:function(){let e={};e.userId=this.authorizeForm.userId,e.roleList=this.authorizeForm.checkedRoles;var t=this;t.$ajax.post("/system/user/authorize",e).then(function(e){e.success&&(t.$message.success("保存成功"),t.$refs.authorizeForm.resetFields(),t.authorizeFormVisible=!1)})}}},F={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("section",[a("el-col",{staticClass:"toolbar",staticStyle:{"padding-bottom":"0px"},attrs:{span:24}},[a("el-form",{attrs:{inline:!0,model:e.queryForm}},[a("el-form-item",[a("el-input",{attrs:{placeholder:"用户名"},model:{value:e.queryForm.userName,callback:function(t){e.$set(e.queryForm,"userName",t)},expression:"queryForm.userName"}})],1),e._v(" "),a("el-form-item",[a("el-input",{attrs:{placeholder:"用户昵称"},model:{value:e.queryForm.nickName,callback:function(t){e.$set(e.queryForm,"nickName",t)},expression:"queryForm.nickName"}})],1),e._v(" "),a("el-form-item",[a("el-input",{attrs:{placeholder:"手机号码"},model:{value:e.queryForm.phone,callback:function(t){e.$set(e.queryForm,"phone",t)},expression:"queryForm.phone"}})],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:e.getTableData}},[e._v("查询")])],1),e._v(" "),a("el-form-item",[a("el-button",{directives:[{name:"hasPermission",rawName:"v-hasPermission",value:"system.user.add",expression:"'system.user.add'"}],attrs:{type:"primary"},on:{click:e.handleAdd}},[e._v("新增")])],1)],1)],1),e._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],staticStyle:{width:"100%"},attrs:{data:e.tableData,stripe:"","highlight-current-row":"","default-sort":{prop:"createTime",order:"descending"},"empty-text":e.message},on:{"sort-change":e.sortChanged}},[a("el-table-column",{attrs:{type:"expand"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-form",{staticClass:"demo-table-expand",attrs:{"label-position":"left",inline:""}},[a("el-form-item",{attrs:{label:"用户名"}},[a("span",[e._v(e._s(t.row.userName))])]),e._v(" "),a("el-form-item",{attrs:{label:"昵称"}},[a("span",[e._v(e._s(t.row.nickName))])]),e._v(" "),a("el-form-item",{attrs:{label:"姓名"}},[a("span",[e._v(e._s(t.row.realName))])]),e._v(" "),a("el-form-item",{attrs:{label:"手机号码"}},[a("span",[e._v(e._s(t.row.phone))])])],1)]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"nickName",label:"昵称",width:"100"}}),e._v(" "),a("el-table-column",{attrs:{prop:"realName",label:"姓名",width:"100"}}),e._v(" "),a("el-table-column",{attrs:{prop:"phone",label:"手机号码",width:"120"}}),e._v(" "),a("el-table-column",{attrs:{prop:"createTime",label:"创建时间",width:"180",sortable:"custom"}}),e._v(" "),a("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{directives:[{name:"hasPermission",rawName:"v-hasPermission",value:"system.user.edit",expression:"'system.user.edit'"}],attrs:{size:"small"},on:{click:function(a){e.handleEdit(t.$index,t.row)}}},[e._v("编辑")]),e._v(" "),a("el-button",{directives:[{name:"hasPermission",rawName:"v-hasPermission",value:"system.user.authorize",expression:"'system.user.authorize'"}],attrs:{type:"warning",size:"small"},on:{click:function(a){e.authorize(t.$index,t.row)}}},[e._v("授权")]),e._v(" "),a("el-button",{directives:[{name:"hasPermission",rawName:"v-hasPermission",value:"system.user.delete",expression:"'system.user.delete'"}],attrs:{type:"danger",size:"small"},on:{click:function(a){e.handleDel(t.$index,t.row)}}},[e._v("删除")])]}}])})],1),e._v(" "),a("el-col",{staticClass:"toolbar",attrs:{span:24}},[a("el-pagination",{staticStyle:{float:"right"},attrs:{layout:"total, prev, pager, next","page-size":e.pageSize,total:e.total,"prev-text":"上一页","next-text":"下一页",background:""},on:{"current-change":e.handleCurrentChange}})],1),e._v(" "),a("el-dialog",{attrs:{title:"编辑",visible:e.editFormVisible,"close-on-click-modal":!1},on:{"update:visible":function(t){e.editFormVisible=t}}},[a("el-form",{ref:"editForm",attrs:{model:e.editForm,"label-width":"80px",rules:e.editFormRules}},[a("el-form-item",{attrs:{label:"用户名",prop:"userName"}},[a("el-input",{attrs:{"auto-complete":"off"},model:{value:e.editForm.userName,callback:function(t){e.$set(e.editForm,"userName",t)},expression:"editForm.userName"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"密码",prop:"password"}},[a("el-input",{attrs:{type:"password","auto-complete":"off"},model:{value:e.editForm.password,callback:function(t){e.$set(e.editForm,"password",t)},expression:"editForm.password"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"昵称",prop:"nickName"}},[a("el-input",{attrs:{"auto-complete":"off"},model:{value:e.editForm.nickName,callback:function(t){e.$set(e.editForm,"nickName",t)},expression:"editForm.nickName"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"姓名",prop:"realName"}},[a("el-input",{attrs:{"auto-complete":"off"},model:{value:e.editForm.realName,callback:function(t){e.$set(e.editForm,"realName",t)},expression:"editForm.realName"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"手机号码",prop:"phone"}},[a("el-input",{attrs:{"auto-complete":"off"},model:{value:e.editForm.phone,callback:function(t){e.$set(e.editForm,"phone",t)},expression:"editForm.phone"}})],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{nativeOn:{click:function(t){e.editFormVisible=!1}}},[e._v("取消")]),e._v(" "),a("el-button",{attrs:{type:"primary",loading:e.editLoading},nativeOn:{click:function(t){return e.editSubmit(t)}}},[e._v("提交")])],1)],1),e._v(" "),a("el-dialog",{attrs:{title:"新增",visible:e.addFormVisible,"close-on-click-modal":!1},on:{"update:visible":function(t){e.addFormVisible=t}}},[a("el-form",{ref:"addForm",attrs:{model:e.addForm,"label-width":"80px",rules:e.addFormRules}},[a("el-form-item",{attrs:{label:"用户名",prop:"userName"}},[a("el-input",{attrs:{"auto-complete":"off"},model:{value:e.addForm.userName,callback:function(t){e.$set(e.addForm,"userName",t)},expression:"addForm.userName"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"密码",prop:"password"}},[a("el-input",{attrs:{type:"password","auto-complete":"off"},model:{value:e.addForm.password,callback:function(t){e.$set(e.addForm,"password",t)},expression:"addForm.password"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"昵称",prop:"nickName"}},[a("el-input",{attrs:{"auto-complete":"off"},model:{value:e.addForm.nickName,callback:function(t){e.$set(e.addForm,"nickName",t)},expression:"addForm.nickName"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"姓名",prop:"realName"}},[a("el-input",{attrs:{"auto-complete":"off"},model:{value:e.addForm.realName,callback:function(t){e.$set(e.addForm,"realName",t)},expression:"addForm.realName"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"手机号码",prop:"phone"}},[a("el-input",{attrs:{"auto-complete":"off"},model:{value:e.addForm.phone,callback:function(t){e.$set(e.addForm,"phone",t)},expression:"addForm.phone"}})],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{nativeOn:{click:function(t){e.addFormVisible=!1}}},[e._v("取消")]),e._v(" "),a("el-button",{attrs:{type:"primary",loading:e.addLoading},nativeOn:{click:function(t){return e.addSubmit(t)}}},[e._v("提交")])],1)],1),e._v(" "),a("el-dialog",{attrs:{title:"分配角色",visible:e.authorizeFormVisible,"close-on-click-modal":!1},on:{"update:visible":function(t){e.authorizeFormVisible=t}}},[a("el-form",{ref:"authorizeForm",attrs:{model:e.authorizeForm,"label-width":"80px"}},[a("el-form-item",{attrs:{label:"用户"}},[a("span",[e._v(e._s(e.authorizeForm.userName))])]),e._v(" "),a("el-form-item",{attrs:{label:"角色"}},[a("el-checkbox",{attrs:{indeterminate:e.authorizeForm.isIndeterminate},on:{change:e.handleCheckAllChange},model:{value:e.authorizeForm.checkAll,callback:function(t){e.$set(e.authorizeForm,"checkAll",t)},expression:"authorizeForm.checkAll"}},[e._v("全选")]),e._v(" "),a("el-checkbox-group",{on:{change:e.handleCheckedRolesChange},model:{value:e.authorizeForm.checkedRoles,callback:function(t){e.$set(e.authorizeForm,"checkedRoles",t)},expression:"authorizeForm.checkedRoles"}},e._l(e.authorizeForm.roles,function(t){return a("el-checkbox",{key:t.id,attrs:{label:t.id}},[e._v(e._s(t.roleName))])}))],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{nativeOn:{click:function(t){e.authorizeFormVisible=!1}}},[e._v("取消")]),e._v(" "),a("el-button",{attrs:{type:"primary",loading:e.authorizeLoading},nativeOn:{click:function(t){return e.authorizeSubmit(t)}}},[e._v("提交")])],1)],1)],1)},staticRenderFns:[]};var w=a("VU/8")(_,F,!1,function(e){a("zNWp")},"data-v-688fb978",null).exports,k={data:()=>({filterText:"",queryForm:{authName:""},treeData:[],checkedNodeData:null,defaultProps:{label:"authName",children:"subAuthList"},editFormVisible:!1,editLoading:!1,editFormRules:{authName:[{required:!0,message:"请输入权限名称",trigger:"blur"}],authCode:[{required:!0,message:"请输入权限编码",trigger:"blur"}],authType:[{required:!0,message:"请输入权限类型",trigger:"blur"}]},editForm:{id:0,authName:"",authCode:"",authType:"",parentId:null},addFormVisible:!1,addLoading:!1,addFormRules:{authName:[{required:!0,message:"请输入权限名称",trigger:"blur"}],authCode:[{required:!0,message:"请输入权限编码",trigger:"blur"}],authType:[{required:!0,message:"请输入权限类型",trigger:"blur"}]},addForm:{authName:"",authCode:"",authType:"",parentId:null},detailFormVisible:!1,detailForm:{}}),methods:{filterNode:(e,t)=>!e||(-1===t.id||-1!==t.authName.indexOf(e)),checkNode(e,t){this.checkedNodeData=e},getTreeData(){var e=this;e.$ajax.get("/system/auth/tree").then(t=>{e.treeData=[],t.success?e.treeData.push(t.root):e.treeData.push({id:-1,authName:"权限树",subAuthList:[]})})},handleDel:function(){var e=this;null!=e.checkedNodeData?-1!==e.checkedNodeData.id?e.$confirm("确认删除权限【"+e.checkedNodeData.authName+"】吗？","提示",{}).then(function(){e.$ajax.post("/system/auth/delete/"+e.checkedNodeData.id).then(function(t){t.success&&(e.$message.success("删除成功"),e.checkedNodeData=null,e.getTreeData())})}):e.$message.info("【权限树】节点不能删除"):e.$message.info("请选择要删除的权限节点")},handleEdit:function(){var e=this;null!=e.checkedNodeData?-1!==e.checkedNodeData.id?e.$ajax.get("/system/auth/get/"+e.checkedNodeData.id).then(function(t){t.success&&(e.editForm=t.data,e.checkedNodeData=null,e.editFormVisible=!0)}):e.$message.info("【权限树】节点不能编辑"):e.$message.info("请选择要编辑的权限节点")},handleAdd:function(){null!=this.checkedNodeData?(this.addForm={authName:"",authCode:"",authType:"",parentId:null},-1!==this.checkedNodeData.id&&(this.addForm.parentId=this.checkedNodeData.id),this.checkedNodeData=null,this.addFormVisible=!0):this.$message.info("请选择父权限节点")},handleDetail:function(){var e=this;null!=e.checkedNodeData?-1!==e.checkedNodeData.id?e.$ajax.get("/system/auth/get/"+e.checkedNodeData.id).then(function(t){t.success&&(e.detailForm=t.data,e.checkedNodeData=null,e.detailFormVisible=!0)}):e.$message.info("【权限树】节点无详情"):e.$message.info("请选择权限节点")},editSubmit:function(){var e=this;e.$refs.editForm.validate(t=>{t&&e.$confirm("确认提交吗？","提示",{}).then(()=>{e.editLoading=!0;let t=Object.assign({},e.editForm);e.$ajax.post("/system/auth/update",t).then(t=>{e.editLoading=!1,t.success&&(e.$message({message:"提交成功",type:"success"}),e.$refs.editForm.resetFields(),e.editFormVisible=!1,e.getTreeData())})})})},addSubmit:function(){var e=this;e.$refs.addForm.validate(t=>{t&&e.$confirm("确认提交吗？","提示",{}).then(()=>{e.addLoading=!0;let t=Object.assign({},e.addForm);e.$ajax.post("/system/auth/add",t).then(t=>{e.addLoading=!1,t.success&&(e.$message({message:"提交成功",type:"success"}),e.$refs.addForm.resetFields(),e.addFormVisible=!1,e.getTreeData())})})})}},mounted(){this.getTreeData()},watch:{filterText(e){this.$refs.tree.filter(e)}}},x={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("section",[a("el-col",{staticClass:"toolbar",staticStyle:{"padding-bottom":"0px"},attrs:{span:24}},[a("el-form",{attrs:{inline:!0,model:e.queryForm}},[a("el-form-item",[a("el-input",{attrs:{placeholder:"输入权限名称过滤"},model:{value:e.filterText,callback:function(t){e.filterText=t},expression:"filterText"}})],1),e._v(" "),a("el-form-item",[a("el-button",{directives:[{name:"hasPermission",rawName:"v-hasPermission",value:"system.auth.detail",expression:"'system.auth.detail'"}],attrs:{disabled:null===this.checkedNodeData},on:{click:e.handleDetail}},[e._v("详情")])],1),e._v(" "),a("el-form-item",[a("el-button",{directives:[{name:"hasPermission",rawName:"v-hasPermission",value:"system.auth.add",expression:"'system.auth.add'"}],attrs:{type:"primary",disabled:null===this.checkedNodeData},on:{click:e.handleAdd}},[e._v("新增")])],1),e._v(" "),a("el-form-item",[a("el-button",{directives:[{name:"hasPermission",rawName:"v-hasPermission",value:"system.auth.update",expression:"'system.auth.update'"}],attrs:{type:"warning",disabled:null===this.checkedNodeData},on:{click:e.handleEdit}},[e._v("修改")])],1),e._v(" "),a("el-form-item",[a("el-button",{directives:[{name:"hasPermission",rawName:"v-hasPermission",value:"system.auth.delete",expression:"'system.auth.delete'"}],attrs:{type:"danger",disabled:null===this.checkedNodeData},on:{click:e.handleDel}},[e._v("删除")])],1)],1)],1),e._v(" "),a("el-col",{attrs:{span:24}},[a("el-tree",{ref:"tree",staticClass:"filter-tree",attrs:{data:e.treeData,props:e.defaultProps,"node-key":"id","auto-expand-parent":"","filter-node-method":e.filterNode,"default-expanded-keys":[-1],accordion:""},on:{"node-click":e.checkNode}})],1),e._v(" "),a("el-dialog",{attrs:{title:"编辑",visible:e.editFormVisible,"close-on-click-modal":!1},on:{"update:visible":function(t){e.editFormVisible=t}}},[a("el-form",{ref:"editForm",attrs:{model:e.editForm,"label-width":"80px",rules:e.editFormRules}},[a("el-form-item",{attrs:{label:"权限名称",prop:"authName"}},[a("el-input",{attrs:{"auto-complete":"off"},model:{value:e.editForm.authName,callback:function(t){e.$set(e.editForm,"authName",t)},expression:"editForm.authName"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"权限编码",prop:"authCode"}},[a("el-input",{attrs:{"auto-complete":"off"},model:{value:e.editForm.authCode,callback:function(t){e.$set(e.editForm,"authCode",t)},expression:"editForm.authCode"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"权限类型",prop:"authType"}},[a("el-radio-group",{model:{value:e.editForm.authType,callback:function(t){e.$set(e.editForm,"authType",t)},expression:"editForm.authType"}},[a("el-radio",{attrs:{label:"menu"}},[e._v("菜单权限")]),e._v(" "),a("el-radio",{attrs:{label:"oper"}},[e._v("功能权限")])],1)],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{nativeOn:{click:function(t){e.editFormVisible=!1}}},[e._v("取消")]),e._v(" "),a("el-button",{attrs:{type:"primary",loading:e.editLoading},nativeOn:{click:function(t){return e.editSubmit(t)}}},[e._v("提交")])],1)],1),e._v(" "),a("el-dialog",{attrs:{title:"新增",visible:e.addFormVisible,"close-on-click-modal":!1},on:{"update:visible":function(t){e.addFormVisible=t}}},[a("el-form",{ref:"addForm",attrs:{model:e.addForm,"label-width":"80px",rules:e.addFormRules}},[a("el-form-item",{attrs:{label:"权限名称",prop:"authName"}},[a("el-input",{attrs:{"auto-complete":"off"},model:{value:e.addForm.authName,callback:function(t){e.$set(e.addForm,"authName",t)},expression:"addForm.authName"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"权限编码",prop:"authCode"}},[a("el-input",{attrs:{"auto-complete":"off"},model:{value:e.addForm.authCode,callback:function(t){e.$set(e.addForm,"authCode",t)},expression:"addForm.authCode"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"权限类型",prop:"authType"}},[a("el-radio-group",{model:{value:e.addForm.authType,callback:function(t){e.$set(e.addForm,"authType",t)},expression:"addForm.authType"}},[a("el-radio",{attrs:{label:"menu"}},[e._v("菜单权限")]),e._v(" "),a("el-radio",{attrs:{label:"oper"}},[e._v("功能权限")])],1)],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{nativeOn:{click:function(t){e.addFormVisible=!1}}},[e._v("取消")]),e._v(" "),a("el-button",{attrs:{type:"primary",loading:e.addLoading},nativeOn:{click:function(t){return e.addSubmit(t)}}},[e._v("提交")])],1)],1),e._v(" "),a("el-dialog",{attrs:{title:"详情",visible:e.detailFormVisible,"close-on-click-modal":!1},on:{"update:visible":function(t){e.detailFormVisible=t}}},[a("el-form",{ref:"detailForm",attrs:{model:e.detailForm,"label-width":"80px"}},[a("el-form-item",{attrs:{label:"权限名称"}},[a("span",[e._v(e._s(e.detailForm.authName))])]),e._v(" "),a("el-form-item",{attrs:{label:"权限编码"}},[a("span",[e._v(e._s(e.detailForm.authCode))])]),e._v(" "),a("el-form-item",{attrs:{label:"权限类型"}},[a("span",[e._v(e._s(e.detailForm.authTypeName))])]),e._v(" "),a("el-form-item",{attrs:{label:"权限层级"}},[a("span",[e._v(e._s(e.detailForm.level))])]),e._v(" "),a("el-form-item",{attrs:{label:"创建时间"}},[a("span",[e._v(e._s(e.detailForm.createTime))])])],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{nativeOn:{click:function(t){e.detailFormVisible=!1}}},[e._v("返回")])],1)],1)],1)},staticRenderFns:[]};var N=a("VU/8")(k,x,!1,function(e){a("gCNA")},"data-v-cf9c99da",null).exports,$={data:()=>({queryForm:{roleName:""},tableData:[],total:0,pages:0,page:1,pageSize:8,sort:"createTime",order:"desc",message:"",listLoading:!1,sels:[],editFormVisible:!1,editLoading:!1,editFormRules:{roleName:[{required:!0,message:"请输入角色名称",trigger:"blur"}]},editForm:{id:0,roleName:""},addFormVisible:!1,addLoading:!1,addFormRules:{roleName:[{required:!0,message:"请输入角色名称",trigger:"blur"}]},addForm:{roleName:""},authorizeFormVisible:!1,authorizeLoading:!1,authorizeForm:{roleId:0,checkedAuths:[],roleName:"",auths:[],defaultProps:{label:"authName",children:"subAuthList"}}}),methods:{handleCurrentChange(e){this.page=e,this.getTableData()},getTableData(){var e=this;let t={roleName:e.queryForm.roleName,page:e.page,pageSize:e.pageSize,sort:e.sort,order:e.order};e.listLoading=!0,e.$ajax.get("/system/role/page",t).then(t=>{e.listLoading=!1,t.success?(e.page=t.page,e.pageSize=t.pageSize,e.total=t.total,e.pages=t.pages,e.tableData=t.data):(e.tableData=[],e.page=0,e.total=0,e.pages=0,e.message=t.message)})},handleDel:function(e,t){var a=this;a.$confirm("确认删除该记录吗?","提示",{type:"warning"}).then(()=>{a.listLoading=!0,a.$ajax.post("/system/role/delete/"+t.id).then(e=>{a.listLoading=!1,e.success&&(a.$message({message:"删除成功",type:"success"}),a.getTableData())})}).catch(()=>{})},handleEdit:function(e,t){this.editFormVisible=!0,this.editForm=Object.assign({},t)},handleAdd:function(){this.addFormVisible=!0,this.addForm={roleName:""}},editSubmit:function(){var e=this;e.$refs.editForm.validate(t=>{t&&e.$confirm("确认提交吗？","提示",{}).then(()=>{e.editLoading=!0;let t=Object.assign({},e.editForm);e.$ajax.post("/system/role/update",t).then(t=>{e.editLoading=!1,t.success&&(e.$message({message:"提交成功",type:"success"}),e.$refs.editForm.resetFields(),e.editFormVisible=!1,e.getTableData())})})})},addSubmit:function(){var e=this;e.$refs.addForm.validate(t=>{t&&e.$confirm("确认提交吗？","提示",{}).then(()=>{e.addLoading=!0;let t=Object.assign({},e.addForm);e.$ajax.post("/system/role/add",t).then(t=>{e.addLoading=!1,t.success&&(e.$message({message:"提交成功",type:"success"}),e.$refs.addForm.resetFields(),e.addFormVisible=!1,e.getTableData())})})})},selsChange:function(e){this.sels=e},batchRemove:function(){var e=this,t=e.sels.map(e=>e.id).toString();e.$confirm("确认删除选中记录吗？","提示",{type:"warning"}).then(()=>{e.listLoading=!0;let a={ids:t};e.$ajax.post("/system/role/delete/batch",a).then(t=>{e.listLoading=!1,t.success&&(e.$message({message:"删除成功",type:"success"}),e.getTableData())})}).catch(()=>{})},sortChanged:function(e){this.sort=e.prop,this.order="ascending"===e.order?"asc":"desc",this.getTableData()},authorize:function(e,t){this.authorizeForm.roleId=t.id,this.authorizeForm.roleName=t.roleName;var a=this;Promise.all([a.$ajax.get("/system/role/"+t.id+"/auths/").then(function(e){return e.success?(a.authorizeForm.checkedAuths=e.data,Promise.resolve(0)):Promise.reject(-1)}),a.$ajax.get("/system/auth/tree").then(function(e){return a.authorizeForm.auths=[],e.success?(a.authorizeForm.auths.push(e.root),Promise.resolve(0)):Promise.reject(-2)})]).then(function(){a.authorizeFormVisible=!0},function(e){-2==e?a.$message.info("请先配置系统权限"):a.$message.error("系统错误")})},checkChange:function(){this.authorizeForm.checkedAuths=this.$refs.tree.getCheckedKeys()},authorizeSubmit:function(){let e={};e.roleId=this.authorizeForm.roleId,e.authList=this.authorizeForm.checkedAuths;var t=this;t.$ajax.post("/system/role/authorize",e).then(function(e){e.success&&(t.$message.success("保存成功"),t.$refs.authorizeForm.resetFields(),t.authorizeFormVisible=!1)})}}},C={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("section",[a("el-col",{staticClass:"toolbar",staticStyle:{"padding-bottom":"0px"},attrs:{span:24}},[a("el-form",{attrs:{inline:!0,model:e.queryForm}},[a("el-form-item",[a("el-input",{attrs:{placeholder:"角色名称"},model:{value:e.queryForm.roleName,callback:function(t){e.$set(e.queryForm,"roleName",t)},expression:"queryForm.roleName"}})],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:e.getTableData}},[e._v("查询")])],1),e._v(" "),a("el-form-item",[a("el-button",{directives:[{name:"hasPermission",rawName:"v-hasPermission",value:"system.role.add",expression:"'system.role.add'"}],attrs:{type:"primary"},on:{click:e.handleAdd}},[e._v("新增")])],1)],1)],1),e._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],staticStyle:{width:"100%"},attrs:{data:e.tableData,stripe:"","highlight-current-row":"","default-sort":{prop:"createTime",order:"descending"},"empty-text":e.message},on:{"sort-change":e.sortChanged,"selection-change":e.selsChange}},[a("el-table-column",{attrs:{type:"selection",width:"40"}}),e._v(" "),a("el-table-column",{attrs:{prop:"roleName",label:"角色名称",width:"240"}}),e._v(" "),a("el-table-column",{attrs:{prop:"createTime",label:"创建时间",width:"250",sortable:"custom"}}),e._v(" "),a("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{directives:[{name:"hasPermission",rawName:"v-hasPermission",value:"system.role.edit",expression:"'system.role.edit'"}],attrs:{size:"small"},on:{click:function(a){e.handleEdit(t.$index,t.row)}}},[e._v("编辑")]),e._v(" "),a("el-button",{directives:[{name:"hasPermission",rawName:"v-hasPermission",value:"system.role.authorize",expression:"'system.role.authorize'"}],attrs:{type:"warning",size:"small"},on:{click:function(a){e.authorize(t.$index,t.row)}}},[e._v("授权")]),e._v(" "),a("el-button",{directives:[{name:"hasPermission",rawName:"v-hasPermission",value:"system.role.delete",expression:"'system.role.delete'"}],attrs:{type:"danger",size:"small"},on:{click:function(a){e.handleDel(t.$index,t.row)}}},[e._v("删除")])]}}])})],1),e._v(" "),a("el-col",{staticClass:"toolbar",attrs:{span:24}},[a("el-button",{directives:[{name:"hasPermission",rawName:"v-hasPermission",value:"system.role.delete",expression:"'system.role.delete'"}],attrs:{type:"danger",disabled:0===this.sels.length},on:{click:e.batchRemove}},[e._v("批量删除")]),e._v(" "),a("el-pagination",{staticStyle:{float:"right"},attrs:{layout:"total, prev, pager, next","page-size":e.pageSize,total:e.total,"prev-text":"上一页","next-text":"下一页",background:""},on:{"current-change":e.handleCurrentChange}})],1),e._v(" "),a("el-dialog",{attrs:{title:"编辑",visible:e.editFormVisible,"close-on-click-modal":!1},on:{"update:visible":function(t){e.editFormVisible=t}}},[a("el-form",{ref:"editForm",attrs:{model:e.editForm,"label-width":"80px",rules:e.editFormRules}},[a("el-form-item",{attrs:{label:"角色名称",prop:"roleName"}},[a("el-input",{attrs:{"auto-complete":"off"},model:{value:e.editForm.roleName,callback:function(t){e.$set(e.editForm,"roleName",t)},expression:"editForm.roleName"}})],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{nativeOn:{click:function(t){e.editFormVisible=!1}}},[e._v("取消")]),e._v(" "),a("el-button",{attrs:{type:"primary",loading:e.editLoading},nativeOn:{click:function(t){return e.editSubmit(t)}}},[e._v("提交")])],1)],1),e._v(" "),a("el-dialog",{attrs:{title:"新增",visible:e.addFormVisible,"close-on-click-modal":!1},on:{"update:visible":function(t){e.addFormVisible=t}}},[a("el-form",{ref:"addForm",attrs:{model:e.addForm,"label-width":"80px",rules:e.addFormRules}},[a("el-form-item",{attrs:{label:"角色名称",prop:"roleName"}},[a("el-input",{attrs:{"auto-complete":"off"},model:{value:e.addForm.roleName,callback:function(t){e.$set(e.addForm,"roleName",t)},expression:"addForm.roleName"}})],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{nativeOn:{click:function(t){e.addFormVisible=!1}}},[e._v("取消")]),e._v(" "),a("el-button",{attrs:{type:"primary",loading:e.addLoading},nativeOn:{click:function(t){return e.addSubmit(t)}}},[e._v("提交")])],1)],1),e._v(" "),a("el-dialog",{attrs:{title:"分配权限",visible:e.authorizeFormVisible,"close-on-click-modal":!1},on:{"update:visible":function(t){e.authorizeFormVisible=t}}},[a("el-form",{ref:"authorizeForm",attrs:{model:e.authorizeForm,"label-width":"80px"}},[a("el-form-item",{attrs:{label:"角色"}},[a("span",[e._v(e._s(e.authorizeForm.roleName))])]),e._v(" "),a("el-form-item",{attrs:{label:"权限"}},[a("el-tree",{ref:"tree",attrs:{"show-checkbox":"",data:e.authorizeForm.auths,props:e.authorizeForm.defaultProps,"node-key":"id","auto-expand-parent":"","default-expanded-keys":[-1],"default-checked-keys":e.authorizeForm.checkedAuths,accordion:"","check-strictly":""},on:{"check-change":e.checkChange}})],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{nativeOn:{click:function(t){e.authorizeFormVisible=!1}}},[e._v("取消")]),e._v(" "),a("el-button",{attrs:{type:"primary",loading:e.authorizeLoading},nativeOn:{click:function(t){return e.authorizeSubmit(t)}}},[e._v("提交")])],1)],1)],1)},staticRenderFns:[]};var z=a("VU/8")($,C,!1,function(e){a("+1Ij")},"data-v-0710d89f",null).exports,L={data:()=>({queryForm:{userName:"",module:"",operType:"",modules:{},operTypes:{}},tableData:[],total:0,pages:0,page:1,pageSize:8,sort:"operateTime",order:"desc",message:"",listLoading:!1,detailFormVisible:!1,detailLoading:!1,detailForm:[]}),methods:{handleCurrentChange(e){this.page=e,this.getTableData()},getTableData(){var e=this;let t={userName:e.queryForm.userName,module:e.queryForm.module,operType:e.queryForm.operType,page:e.page,pageSize:e.pageSize,sort:e.sort,order:e.order};e.listLoading=!0,e.$ajax.get("/system/log/operation/page",t).then(t=>{e.listLoading=!1,t.success?(e.page=t.page,e.pageSize=t.pageSize,e.total=t.total,e.pages=t.pages,e.tableData=t.data):(e.tableData=[],e.page=0,e.total=0,e.pages=0,e.message=t.message)})},handleDetail:function(e,t){var a=this;a.$ajax.get("/system/log/get/"+t.id).then(function(e){e.success?(a.detailForm=e.data,a.detailFormVisible=!0):a.$message.error(e.message)})},sortChanged:function(e){this.sort=e.prop,this.order="ascending"===e.order?"asc":"desc",this.getTableData()}},created(){var e=this;e.$ajax.get("/system/log/module").then(function(t){t.success&&(e.queryForm.modules=t.data)}),e.$ajax.get("/system/log/operType").then(function(t){t.success&&(e.queryForm.operTypes=t.data)})}},S={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("section",[a("el-col",{staticClass:"toolbar",staticStyle:{"padding-bottom":"0px"},attrs:{span:24}},[a("el-form",{attrs:{inline:!0,model:e.queryForm}},[a("el-form-item",[a("el-input",{attrs:{placeholder:"操作人姓名"},model:{value:e.queryForm.userName,callback:function(t){e.$set(e.queryForm,"userName",t)},expression:"queryForm.userName"}})],1),e._v(" "),a("el-form-item",[a("el-select",{attrs:{placeholder:"请选择模块"},model:{value:e.queryForm.module,callback:function(t){e.$set(e.queryForm,"module",t)},expression:"queryForm.module"}},e._l(e.queryForm.modules,function(e,t){return a("el-option",{key:t,attrs:{label:e,value:t}})}))],1),e._v(" "),a("el-form-item",[a("el-select",{attrs:{placeholder:"请选择操作类型"},model:{value:e.queryForm.operType,callback:function(t){e.$set(e.queryForm,"operType",t)},expression:"queryForm.operType"}},e._l(e.queryForm.operTypes,function(e,t){return a("el-option",{key:t,attrs:{label:e,value:t}})}))],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:e.getTableData}},[e._v("查询")])],1)],1)],1),e._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],staticStyle:{width:"100%"},attrs:{data:e.tableData,stripe:"","highlight-current-row":"","default-sort":{prop:"operateTime",order:"descending"},"empty-text":e.message},on:{"sort-change":e.sortChanged}},[a("el-table-column",{attrs:{prop:"userName",label:"操作人",width:"100","show-overflow-tooltip":"",sortable:"custom"}}),e._v(" "),a("el-table-column",{attrs:{prop:"module",label:"操作模块",width:"120","show-overflow-tooltip":"",sortable:"custom"}}),e._v(" "),a("el-table-column",{attrs:{prop:"operType",label:"操作类型",width:"120","show-overflow-tooltip":"",sortable:"custom"}}),e._v(" "),a("el-table-column",{attrs:{prop:"title",label:"操作简介",width:"150","show-overflow-tooltip":""}}),e._v(" "),a("el-table-column",{attrs:{prop:"operateTime",label:"操作时间",width:"250",sortable:"custom"}}),e._v(" "),a("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{directives:[{name:"hasPermission",rawName:"v-hasPermission",value:"system.log.detail",expression:"'system.log.detail'"}],attrs:{size:"small"},on:{click:function(a){e.handleDetail(t.$index,t.row)}}},[e._v("详情")])]}}])})],1),e._v(" "),a("el-col",{staticClass:"toolbar",attrs:{span:24}},[a("el-pagination",{staticStyle:{float:"right"},attrs:{layout:"total, prev, pager, next","page-size":e.pageSize,total:e.total,"prev-text":"上一页","next-text":"下一页",background:""},on:{"current-change":e.handleCurrentChange}})],1),e._v(" "),a("el-dialog",{attrs:{title:"详情",visible:e.detailFormVisible,"close-on-click-modal":!1},on:{"update:visible":function(t){e.detailFormVisible=t}}},[a("el-form",{ref:"detailForm",attrs:{model:e.detailForm,"label-width":"80px","label-position":"left"}},[a("el-row",[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"操作人"}},[a("span",[e._v(e._s(e.detailForm.userName))])])],1),e._v(" "),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"操作IP"}},[a("span",[e._v(e._s(e.detailForm.clientIp))])])],1),e._v(" "),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"操作模块"}},[a("span",[e._v(e._s(e.queryForm.modules[e.detailForm.module]||"未知模块"))])])],1),e._v(" "),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"操作类型"}},[a("span",[e._v(e._s(e.queryForm.operTypes[e.detailForm.operType]||"未知类型"))])])],1),e._v(" "),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"操作简介"}},[a("span",[e._v(e._s(e.detailForm.title))])])],1),e._v(" "),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"操作耗时"}},[a("span",[e._v(e._s(e.detailForm.time)+"ms")])])],1),e._v(" "),a("el-col",{attrs:{span:24}},[a("el-form-item",{attrs:{label:"操作结果"}},[a("span",[e._v(e._s(e.detailForm.result))])])],1),e._v(" "),a("el-col",{attrs:{span:24}},[a("el-form-item",{attrs:{label:"操作参数"}},[a("div",{staticClass:"wrap"},[e._v(e._s(e.detailForm.params))])])],1),e._v(" "),a("el-col",{attrs:{span:24}},[a("el-form-item",{attrs:{label:"操作内容"}},[a("div",{staticClass:"wrap"},[e._v(e._s(e.detailForm.content))])])],1)],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{nativeOn:{click:function(t){e.detailFormVisible=!1}}},[e._v("返回")])],1)],1)],1)},staticRenderFns:[]};var D=a("VU/8")(L,S,!1,function(e){a("FRYC")},"data-v-12c048d0",null).exports,T={data:()=>({user:{userName:"",nickName:"",phone:"",realName:"",imageUrl:""},service:"",pwdFormRules:{oldpwd:[{required:!0,message:"请输入原密码",trigger:"blur"}],newpwd:[{required:!0,message:"请输入新密码",trigger:"blur"}],secondpwd:[{required:!0,message:"请确认密码",trigger:"blur"}]},pwdForm:{newpwd:"",oldpwd:"",secondpwd:""},pwdFormVisible:!1,pwdLoading:!1,phoneFormRules:{phone:[{required:!0,message:"请输入手机号",trigger:"blur"}]},phoneForm:{phone:""},phoneFormVisible:!1,phoneLoading:!1,title:"绑定手机",realNameFormRules:{realName:[{required:!0,message:"请输入姓名",trigger:"blur"}]},realNameForm:{realName:""},realNameFormVisible:!1,realNameLoading:!1,nickNameFormRules:{nickName:[{required:!0,message:"请输入昵称",trigger:"blur"}]},nickNameForm:{nickName:""},nickNameFormVisible:!1,nickNameLoading:!1}),methods:{handleAddSuccess:function(e,t,a){e.success&&this.submitSetting({imageUrl:this.service+e.data[0]})},submitSetting:function(e){let t=Object.assign({},e);return t.id=this.user.id,this.$ajax.post("/system/user/setting/save",t).then(t=>{if(t.success){this.$message.success("保存成功");let t=this.$store.getters.getUser;for(let a in e)t[a]=e[a],this.user[a]=e[a];return this.$store.commit("setUser",t),Promise.resolve(1)}return Promise.reject(0)})},pwdSubmit:function(){this.$refs.pwdForm.validate(e=>{e&&this.$confirm("确认修改密码吗？","提示",{}).then(()=>{this.pwdLoading=!0,this.submitSetting({password:this.pwdForm.newpwd}).then(e=>{this.pwdLoading=!1,this.pwdFormVisible=!1})})})},handleModifyPassword:function(){this.pwdFormVisible=!0},handlePhone:function(){void 0==this.user.phone||null==this.user.phone||""==this.user.phone?this.title="绑定手机":(this.title="更换手机",this.phoneForm.phone=this.user.phone),this.phoneFormVisible=!0},phoneSubmit:function(){this.$refs.phoneForm.validate(e=>{e&&this.$confirm("确认提交吗？","提示",{}).then(()=>{this.phoneLoading=!0,this.submitSetting({phone:this.phoneForm.phone}).then(e=>{this.phoneLoading=!1,this.phoneFormVisible=!1})})})},handleRealName:function(){this.realNameForm.realName=this.user.realName,this.realNameFormVisible=!0},realNameSubmit:function(){this.$refs.realNameForm.validate(e=>{e&&this.$confirm("确认实名吗？","提示",{}).then(()=>{this.realNameLoading=!0,this.submitSetting({realName:this.realNameForm.realName}).then(e=>{this.realNameLoading=!1,this.realNameFormVisible=!1})})})},handleNickName:function(){this.nickNameForm.nickName=this.user.nickName,this.nickNameFormVisible=!0},nickNameSubmit:function(){this.$refs.nickNameForm.validate(e=>{e&&this.$confirm("确认修改昵称吗？","提示",{}).then(()=>{this.nickNameLoading=!0,this.submitSetting({nickName:this.nickNameForm.nickName}).then(e=>{this.nickNameLoading=!1,this.nickNameFormVisible=!1})})})}},mounted(){this.service=this.$imageService,this.user=this.$store.getters.getUser,""!=this.user.imageUrl&&null!=this.user.imageUrl&&void 0!=this.user.imageUrl||(this.user.imageUrl="/static/user.png")},computed:{action:function(){return this.service+"/file/up"}}},P={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("section",[a("div",{staticClass:"setting-box"},[a("div",{staticClass:"avatar-box"},[a("el-upload",{attrs:{"list-type":"avatar-uploader",action:e.action,"show-file-list":!1,"on-success":e.handleAddSuccess,data:{type:"image",size:"150"}}},[e.user.imageUrl?a("img",{staticClass:"avatar",attrs:{src:e.user.imageUrl}}):a("i",{staticClass:"el-icon-plus avatar-uploader-icon"})])],1),e._v(" "),a("div",{staticClass:"form-box"},[a("el-row",[a("span",{staticClass:"lable"},[e._v("用户名:")]),e._v(" "),a("span",{staticClass:"value"},[e._v(e._s(e.user.userName))]),e._v(" "),a("el-button",{staticClass:"btn",attrs:{type:"text"},on:{click:e.handleModifyPassword}},[e._v("修改密码")])],1),e._v(" "),a("el-row",[a("span",{staticClass:"lable"},[e._v("昵称:")]),e._v(" "),a("span",{staticClass:"value"},[e._v(e._s(e.user.nickName))]),e._v(" "),a("el-button",{staticClass:"btn",attrs:{type:"text"},on:{click:e.handleNickName}},[e._v("修改")])],1),e._v(" "),a("el-row",[a("span",{staticClass:"lable"},[e._v("姓名:")]),e._v(" "),a("span",{staticClass:"value"},[e._v(e._s(e.user.realName))]),e._v(" "),void 0==e.user.realName||null==e.user.realName||""==e.user.realName?a("el-button",{staticClass:"btn",attrs:{type:"text"},on:{click:e.handleRealName}},[e._v("去实名")]):e._e()],1),e._v(" "),a("el-row",[a("span",{staticClass:"lable"},[e._v("手机号:")]),e._v(" "),a("span",{staticClass:"value"},[e._v(e._s(e.user.phone))]),e._v(" "),void 0==e.user.phone||null==e.user.phone||""==e.user.phone?a("el-button",{staticClass:"btn",attrs:{type:"text"},on:{click:e.handlePhone}},[e._v("绑定手机")]):a("el-button",{staticClass:"btn",attrs:{type:"text"},on:{click:e.handlePhone}},[e._v("更换手机")])],1)],1)]),e._v(" "),a("el-dialog",{attrs:{title:"修改密码",visible:e.pwdFormVisible,"close-on-click-modal":!1},on:{"update:visible":function(t){e.pwdFormVisible=t}}},[a("el-form",{ref:"pwdForm",attrs:{model:e.pwdForm,"label-width":"80px",rules:e.pwdFormRules}},[a("el-form-item",{attrs:{label:"原密码",prop:"oldpwd"}},[a("el-input",{attrs:{type:"password","auto-complete":"off"},model:{value:e.pwdForm.oldpwd,callback:function(t){e.$set(e.pwdForm,"oldpwd",t)},expression:"pwdForm.oldpwd"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"密码",prop:"newpwd"}},[a("el-input",{attrs:{type:"password","auto-complete":"off"},model:{value:e.pwdForm.newpwd,callback:function(t){e.$set(e.pwdForm,"newpwd",t)},expression:"pwdForm.newpwd"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"确认密码",prop:"secondpwd"}},[a("el-input",{attrs:{type:"password","auto-complete":"off"},model:{value:e.pwdForm.secondpwd,callback:function(t){e.$set(e.pwdForm,"secondpwd",t)},expression:"pwdForm.secondpwd"}})],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{nativeOn:{click:function(t){e.pwdFormVisible=!1}}},[e._v("取消")]),e._v(" "),a("el-button",{attrs:{type:"primary",loading:e.pwdLoading},nativeOn:{click:function(t){return e.pwdSubmit(t)}}},[e._v("提交")])],1)],1),e._v(" "),a("el-dialog",{attrs:{title:e.title,visible:e.phoneFormVisible,"close-on-click-modal":!1},on:{"update:visible":function(t){e.phoneFormVisible=t}}},[a("el-form",{ref:"phoneForm",attrs:{model:e.phoneForm,"label-width":"80px",rules:e.phoneFormRules}},[a("el-form-item",{attrs:{label:"手机号",prop:"phone"}},[a("el-input",{attrs:{"auto-complete":"off"},model:{value:e.phoneForm.phone,callback:function(t){e.$set(e.phoneForm,"phone",t)},expression:"phoneForm.phone"}})],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{nativeOn:{click:function(t){e.phoneFormVisible=!1}}},[e._v("取消")]),e._v(" "),a("el-button",{attrs:{type:"primary",loading:e.phoneLoading},nativeOn:{click:function(t){return e.phoneSubmit(t)}}},[e._v("提交")])],1)],1),e._v(" "),a("el-dialog",{attrs:{title:"实名",visible:e.realNameFormVisible,"close-on-click-modal":!1},on:{"update:visible":function(t){e.realNameFormVisible=t}}},[a("el-form",{ref:"realNameForm",attrs:{model:e.realNameForm,"label-width":"80px",rules:e.realNameFormRules}},[a("el-form-item",{attrs:{label:"姓名",prop:"realName"}},[a("el-input",{attrs:{"auto-complete":"off"},model:{value:e.realNameForm.realName,callback:function(t){e.$set(e.realNameForm,"realName",t)},expression:"realNameForm.realName"}})],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{nativeOn:{click:function(t){e.realNameFormVisible=!1}}},[e._v("取消")]),e._v(" "),a("el-button",{attrs:{type:"primary",loading:e.realNameLoading},nativeOn:{click:function(t){return e.realNameSubmit(t)}}},[e._v("提交")])],1)],1),e._v(" "),a("el-dialog",{attrs:{title:"修改昵称",visible:e.nickNameFormVisible,"close-on-click-modal":!1},on:{"update:visible":function(t){e.nickNameFormVisible=t}}},[a("el-form",{ref:"nickNameForm",attrs:{model:e.nickNameForm,"label-width":"80px",rules:e.nickNameFormRules}},[a("el-form-item",{attrs:{label:"昵称",prop:"nickName"}},[a("el-input",{attrs:{"auto-complete":"off"},model:{value:e.nickNameForm.nickName,callback:function(t){e.$set(e.nickNameForm,"nickName",t)},expression:"nickNameForm.nickName"}})],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{nativeOn:{click:function(t){e.nickNameFormVisible=!1}}},[e._v("取消")]),e._v(" "),a("el-button",{attrs:{type:"primary",loading:e.nickNameLoading},nativeOn:{click:function(t){return e.nickNameSubmit(t)}}},[e._v("提交")])],1)],1)],1)},staticRenderFns:[]};var q=a("VU/8")(T,P,!1,function(e){a("t5Ou")},"data-v-de97b8ce",null).exports,V={data:()=>({queryForm:{name:"",status:""},statuss:{draft:"未上架",on:"上架中",down:"已下架"},tableData:[],total:0,pages:0,page:1,pageSize:8,sort:"createTime",order:"desc",message:"",listLoading:!1,dialogVisible:!1,dialogImageUrl:"",show:"list",submitLoading:!1,editor:void 0,carouselFormRules:{name:[{required:!0,message:"请输入轮播图名称",trigger:"blur"}]},carouselForm:{name:"",path:"",imageUrl:"",plot:""},fileList:[],imageUrlList:[],service:""}),methods:{handleCurrentChange(e){this.page=e,this.getTableData()},handlePicture:function(e){this.dialogImageUrl=e,this.dialogVisible=!0},handlePictureCardPreview:function(e){this.dialogImageUrl=e.url,this.dialogVisible=!0},getTableData(){let e={name:this.queryForm.name,status:this.queryForm.status,page:this.page,pageSize:this.pageSize,sort:this.sort,order:this.order};this.listLoading=!0,this.$ajax.get("/carousel/page",e).then(e=>{this.listLoading=!1,e.success?(this.page=e.page,this.pageSize=e.pageSize,this.total=e.total,this.pages=e.pages,this.tableData=e.data):(this.tableData=[],this.page=0,this.total=0,this.pages=0,this.message=e.message)})},handleDel:function(e,t){this.$confirm("确认删除该轮播图吗?","提示",{type:"warning"}).then(()=>{this.listLoading=!0,this.$ajax.post("/carousel/delete/"+t.id).then(e=>{this.listLoading=!1,e.success&&(this.$message({message:"删除成功",type:"success"}),this.getTableData())})}).catch(()=>{})},handleEdit:function(e,t){this.imageUrlList=[],this.$ajax.get("/carousel/get/"+t.id).then(e=>{if(e.success){if(this.carouselForm=Object.assign({},e.data),this.show="update",this.fileList=[],this.fileList.push({url:e.data.imageUrl}),void 0==this.editor){var t=this,a=window.wangEditor;this.editor=new a("#description"),this.editor.customConfig.uploadImgServer=this.action,this.editor.customConfig.uploadImgMaxSize=10485760,this.editor.customConfig.uploadFileName="file",this.editor.customConfig.uploadImgHooks={customInsert:function(e,a,s){if(a.success){(a.data||[]).forEach(function(a){e(t.service+a)})}}},this.editor.create()}void 0==this.carouselForm.plot&&""==this.carouselForm.plot||this.editor.txt.html(this.carouselForm.plot)}})},handleUp:function(e,t){this.listLoading=!0,this.$ajax.post("/carousel/up/"+t.id).then(e=>{this.listLoading=!1,e.success&&(this.$message.success("上架成功"),this.getTableData())})},handleDown:function(e,t){this.listLoading=!0,this.$ajax.post("/carousel/down/"+t.id).then(e=>{this.listLoading=!1,e.success&&(this.$message.success("下架成功"),this.getTableData())})},handleAdd:function(){if(this.carouselForm={name:"",path:"",imageUrl:"",plot:""},this.fileList=[],this.imageUrlList=[],this.show="add",void 0==this.editor){var e=this,t=window.wangEditor;this.editor=new t("#description"),this.editor.customConfig.uploadImgServer=this.action,this.editor.customConfig.uploadImgMaxSize=10485760,this.editor.customConfig.uploadFileName="file",this.editor.customConfig.uploadImgHooks={customInsert:function(t,a,s){if(a.success){(a.data||[]).forEach(function(a){t(e.service+a)})}}},this.editor.create()}},sortChanged:function(e){this.sort=null!=e.prop?e.prop.replace("Name",""):"",this.order="ascending"===e.order?"asc":"desc",this.getTableData()},handleSuccess:function(e,t,a){e.success&&(this.imageUrlList=[],a.forEach(e=>{void 0===e.response?this.imageUrlList.push(e.url):this.imageUrlList.push(this.service+e.response.data[0])}))},handleRemove:function(e,t){this.imageUrlList=[],t.forEach(e=>{void 0===e.response?this.imageUrlList.push(e.url):this.imageUrlList.push(this.service+e.response.data[0])})},handleSubmit:function(){this.imageUrlList.length>0&&(this.carouselForm.imageUrl=this.imageUrlList[0]),this.editor&&(this.carouselForm.plot=this.editor.txt.html()),this.$refs.carouselForm.validate(e=>{e&&this.$confirm("确认提交吗？","提示",{}).then(()=>{this.submitLoading=!0;let e=Object.assign({},this.carouselForm);this.$ajax.post("/carousel/"+this.show,e).then(e=>{this.submitLoading=!1,e.success&&(this.$message({message:"提交成功",type:"success"}),this.show="list",this.getTableData())})})})},back:function(){this.show="list"}},mounted(){this.service=this.$imageService},computed:{action:function(){return this.service+"/file/up"}}},j={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("section",[a("div",{directives:[{name:"show",rawName:"v-show",value:"list"==e.show,expression:"show=='list'"}]},[a("el-col",{staticClass:"toolbar",staticStyle:{"padding-bottom":"0px"},attrs:{span:24}},[a("el-form",{attrs:{inline:!0,model:e.queryForm}},[a("el-form-item",[a("el-input",{attrs:{placeholder:"轮播图名称"},model:{value:e.queryForm.name,callback:function(t){e.$set(e.queryForm,"name",t)},expression:"queryForm.name"}})],1),e._v(" "),a("el-form-item",[a("el-select",{attrs:{placeholder:"请选择轮播图状态",clearable:""},model:{value:e.queryForm.status,callback:function(t){e.$set(e.queryForm,"status",t)},expression:"queryForm.status"}},e._l(e.statuss,function(e,t){return a("el-option",{key:t,attrs:{label:e,value:t}})}))],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:e.getTableData}},[e._v("查询")]),e._v(" "),a("el-button",{directives:[{name:"hasPermission",rawName:"v-hasPermission",value:"carousel.add",expression:"'carousel.add'"}],attrs:{type:"primary"},on:{click:e.handleAdd}},[e._v("新增")])],1)],1)],1),e._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],staticStyle:{width:"100%"},attrs:{data:e.tableData,stripe:"","highlight-current-row":"","default-sort":{prop:"createTime",order:"descending"},"empty-text":e.message},on:{"sort-change":e.sortChanged}},[a("el-table-column",{attrs:{prop:"name",label:"轮播图名称",width:"150","show-overflow-tooltip":""}}),e._v(" "),a("el-table-column",{attrs:{prop:"imageUrl",label:"轮播图片",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("img",{directives:[{name:"lazy",rawName:"v-lazy",value:t.row.imageUrl,expression:"scope.row.imageUrl"}],staticClass:"img",attrs:{width:"40",height:"40"},on:{click:function(a){e.handlePicture(t.row.imageUrl)}}})]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"path",label:"跳转地址",width:"100","show-overflow-tooltip":""}}),e._v(" "),a("el-table-column",{attrs:{prop:"statusName",label:"轮播图状态",width:"120",sortable:"custom"}}),e._v(" "),a("el-table-column",{attrs:{prop:"createTime",label:"发布时间",width:"150",sortable:"custom","show-overflow-tooltip":""}}),e._v(" "),a("el-table-column",{attrs:{prop:"clicked",label:"点击次数",width:"100"}}),e._v(" "),a("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{directives:[{name:"hasPermission",rawName:"v-hasPermission",value:"carousel.update",expression:"'carousel.update'"}],attrs:{size:"small"},on:{click:function(a){e.handleEdit(t.$index,t.row)}}},[e._v("编辑")]),e._v(" "),"draft"==t.row.status?a("el-button",{directives:[{name:"hasPermission",rawName:"v-hasPermission",value:"carousel.up",expression:"'carousel.up'"}],attrs:{type:"primary",size:"small"},on:{click:function(a){e.handleUp(t.$index,t.row)}}},[e._v("上架")]):e._e(),e._v(" "),"draft"==t.row.status||"down"==t.row.status?a("el-button",{directives:[{name:"hasPermission",rawName:"v-hasPermission",value:"carousel.delete",expression:"'carousel.delete'"}],attrs:{type:"danger",size:"small"},on:{click:function(a){e.handleDel(t.$index,t.row)}}},[e._v("删除")]):e._e(),e._v(" "),"on"==t.row.status?a("el-button",{directives:[{name:"hasPermission",rawName:"v-hasPermission",value:"carousel.down",expression:"'carousel.down'"}],attrs:{type:"warning",size:"small"},on:{click:function(a){e.handleDown(t.$index,t.row)}}},[e._v("下架")]):e._e()]}}])})],1),e._v(" "),a("el-col",{staticClass:"toolbar",attrs:{span:24}},[a("el-pagination",{staticStyle:{float:"right"},attrs:{layout:"total, prev, pager, next","page-size":e.pageSize,total:e.total,"prev-text":"上一页","next-text":"下一页",background:""},on:{"current-change":e.handleCurrentChange}})],1)],1),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:"add"==e.show||"update"==e.show,expression:"show=='add' || show=='update'"}]},[a("el-row",[a("el-col",{attrs:{span:16}},[a("el-form",{ref:"carouselForm",attrs:{model:e.carouselForm,"label-width":"100px",rules:e.carouselFormRules}},[a("el-form-item",{attrs:{label:"轮播图片",required:""}},[a("el-upload",{attrs:{"list-type":"picture-card",action:e.action,"on-preview":e.handlePictureCardPreview,"file-list":e.fileList,"on-success":e.handleSuccess,"on-remove":e.handleRemove,data:{type:"image",size:"700x300"},limit:1}},[a("i",{staticClass:"el-icon-plus"})])],1),e._v(" "),a("el-form-item",{attrs:{label:"轮播图名称",prop:"name"}},[a("el-input",{attrs:{"auto-complete":"off"},model:{value:e.carouselForm.name,callback:function(t){e.$set(e.carouselForm,"name",t)},expression:"carouselForm.name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"跳转地址"}},[a("el-input",{attrs:{"auto-complete":"off"},model:{value:e.carouselForm.path,callback:function(t){e.$set(e.carouselForm,"path",t)},expression:"carouselForm.path"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"轮播详情"}},[a("div",{attrs:{id:"description"}})]),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary",size:"small",loading:e.submitLoading},on:{click:e.handleSubmit}},[e._v("提交")]),e._v(" "),a("el-button",{attrs:{size:"small"},on:{click:e.back}},[e._v("取消")])],1)],1)],1)],1)],1),e._v(" "),a("el-dialog",{attrs:{visible:e.dialogVisible},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("img",{attrs:{width:"100%",src:e.dialogImageUrl}})])],1)},staticRenderFns:[]};var U=a("VU/8")(V,j,!1,function(e){a("ih9G")},"data-v-17d9f45c",null).exports,R={data:()=>({queryForm:{code:"",createTimeStart:"",createTimeEnd:"",codes:{}},tableData:[],total:0,pages:0,page:1,pageSize:10,sort:"createTime",order:"desc",message:"",listLoading:!1}),methods:{handleCurrentChange(e){this.page=e,this.getTableData()},getTableData(){let e={page:this.page,pageSize:this.pageSize,sort:this.sort,order:this.order,code:this.queryForm.code,createTimeStart:this.queryForm.createTimeStart,createTimeEnd:this.queryForm.createTimeEnd};this.listLoading=!0,this.$ajax.get("/interface/page",e).then(e=>{this.listLoading=!1,e.success?(this.page=e.page,this.pageSize=e.pageSize,this.total=e.total,this.pages=e.pages,this.tableData=e.data):(this.tableData=[],this.page=0,this.total=0,this.pages=0,this.message=e.message)})},sortChanged:function(e){this.sort=e.prop,this.order="ascending"===e.order?"asc":"desc",this.getTableData()}},created(){this.$ajax.get("/interface/code").then(e=>{e.success&&(this.queryForm.codes=e.data)})}},O={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("section",[a("el-col",{staticClass:"toolbar",staticStyle:{"padding-bottom":"0px"},attrs:{span:24}},[a("el-form",{attrs:{inline:!0,model:e.queryForm}},[a("el-form-item",[a("el-select",{attrs:{placeholder:"请选择调用接口",clearable:""},model:{value:e.queryForm.code,callback:function(t){e.$set(e.queryForm,"code",t)},expression:"queryForm.code"}},e._l(e.queryForm.codes,function(e,t){return a("el-option",{key:t,attrs:{label:e,value:t}})}))],1),e._v(" "),a("el-form-item",[a("el-date-picker",{attrs:{type:"datetime",placeholder:"选择调用开始日期时间","value-format":"yyyy-MM-dd HH:mm:ss","default-time":"00:00:00"},model:{value:e.queryForm.createTimeStart,callback:function(t){e.$set(e.queryForm,"createTimeStart",t)},expression:"queryForm.createTimeStart"}})],1),e._v(" "),a("el-form-item",[a("el-date-picker",{attrs:{type:"datetime",placeholder:"选择调用结束日期时间","value-format":"yyyy-MM-dd HH:mm:ss","default-time":"23:59:59"},model:{value:e.queryForm.createTimeEnd,callback:function(t){e.$set(e.queryForm,"createTimeEnd",t)},expression:"queryForm.createTimeEnd"}})],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:e.getTableData}},[e._v("查询")])],1)],1)],1),e._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],staticStyle:{width:"100%"},attrs:{data:e.tableData,stripe:"","highlight-current-row":"","default-sort":{prop:"createTime",order:"descending"},"empty-text":e.message},on:{"sort-change":e.sortChanged}},[a("el-table-column",{attrs:{type:"expand"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-form",{staticClass:"demo-table-expand",attrs:{"label-position":"left",inline:""}},[a("el-form-item",[a("div",{staticClass:"text-box"},[a("label",[e._v("请求报文")]),a("span",{staticClass:"text"},[e._v(e._s(t.row.request))])])]),e._v(" "),a("el-form-item",[a("div",{staticClass:"text-box"},[a("label",[e._v("应答报文")]),a("span",{staticClass:"text"},[e._v(e._s(t.row.response))])])])],1)]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"code",label:"接口代码"}}),e._v(" "),a("el-table-column",{attrs:{prop:"name",label:"接口名称"}}),e._v(" "),a("el-table-column",{attrs:{prop:"type",label:"接口类型"}}),e._v(" "),a("el-table-column",{attrs:{prop:"createTime",label:"调用时间",sortable:"custom"}})],1),e._v(" "),a("el-col",{staticClass:"toolbar",attrs:{span:24}},[a("el-pagination",{staticStyle:{float:"right"},attrs:{layout:"total, prev, pager, next","page-size":e.pageSize,total:e.total,"prev-text":"上一页","next-text":"下一页",background:""},on:{"current-change":e.handleCurrentChange}})],1)],1)},staticRenderFns:[]};var E=a("VU/8")(R,O,!1,function(e){a("Lzv7")},"data-v-29020746",null).exports,I={data:()=>({queryForm:{nickName:"",status:""},tableData:[],statuss:{normal:"正常",locked:"锁定"},total:0,pages:0,page:1,pageSize:8,sort:"createTime",order:"desc",message:"",listLoading:!1,view:"list",customer:{}}),methods:{handleCurrentChange(e){this.page=e,this.getTableData()},getTableData(){let e={nickName:this.queryForm.nickName,status:this.queryForm.status,page:this.page,pageSize:this.pageSize,sort:this.sort,order:this.order};this.listLoading=!0,this.$ajax.get("/customer/page",e).then(e=>{this.listLoading=!1,e.success?(this.page=e.page,this.pageSize=e.pageSize,this.total=e.total,this.pages=e.pages,this.tableData=e.data):(this.tableData=[],this.page=0,this.total=0,this.pages=0,this.message=e.message)})},handleLock:function(e,t){this.$confirm("确认锁定客户【"+t.nickName+"】吗?","提示",{type:"warning"}).then(()=>{this.listLoading=!0,this.$ajax.post("/customer/lock/"+t.id).then(e=>{this.listLoading=!1,e.success&&(this.$message({message:"已锁定",type:"success"}),this.getTableData())})}).catch(()=>{})},handleUnlock:function(e,t){this.$confirm("确认解锁客户【"+t.nickName+"】吗?","提示",{type:"warning"}).then(()=>{this.listLoading=!0,this.$ajax.post("/customer/unlock/"+t.id).then(e=>{this.listLoading=!1,e.success&&(this.$message({message:"解锁成功",type:"success"}),this.getTableData())})}).catch(()=>{})},handleDetail:function(e,t){this.$ajax.get("/customer/get/"+t.id).then(e=>{e.success?(this.customer=e.data,this.view="detail"):this.$message.error(e.msg)})},sortChanged:function(e){this.sort=e.prop,this.order="ascending"===e.order?"asc":"desc",this.getTableData()},back:function(){this.view="list"}},computed:{time:function(){if(this.customer.createTime){var e=new Date,t=this.customer.createTime.split(" ")[0].split("-");e.setFullYear(t[0],t[1]-1,t[2]);var a=((new Date).getTime()-e.getTime())/864e5;return a>=365?Math.floor(a/365)+"年":a>=30?Math.floor(a/30)+"个月":Math.ceil(a)+"天"}},createTime:function(){return"注册时间："+this.customer.createTime},status:function(){return"normal"===this.customer.status?"el-icon-success":"el-icon-warning"}}},A={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("section",["list"==e.view?a("div",[a("el-col",{staticClass:"toolbar",staticStyle:{"padding-bottom":"0px"},attrs:{span:24}},[a("el-form",{attrs:{inline:!0,model:e.queryForm}},[a("el-form-item",[a("el-input",{attrs:{placeholder:"客户昵称"},model:{value:e.queryForm.nickName,callback:function(t){e.$set(e.queryForm,"nickName",t)},expression:"queryForm.nickName"}})],1),e._v(" "),a("el-form-item",[a("el-select",{attrs:{placeholder:"请选择账号状态",clearable:""},model:{value:e.queryForm.status,callback:function(t){e.$set(e.queryForm,"status",t)},expression:"queryForm.status"}},e._l(e.statuss,function(e,t){return a("el-option",{key:t,attrs:{label:e,value:t}})}))],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:e.getTableData}},[e._v("查询")])],1)],1)],1),e._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],staticStyle:{width:"100%"},attrs:{data:e.tableData,stripe:"","highlight-current-row":"","default-sort":{prop:"createTime",order:"descending"},"empty-text":e.message},on:{"sort-change":e.sortChanged}},[a("el-table-column",{attrs:{prop:"nickName",label:"客户昵称",width:"250","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(t){return[null!=t.row.avatarUrl?a("div",[a("img",{attrs:{src:t.row.avatarUrl,width:"40",height:"40"}}),e._v(" "),a("span",{staticStyle:{"margin-left":"10px"}},[e._v(e._s(t.row.nickName))])]):a("div",[a("span",{staticStyle:{height:"40px","line-height":"40px"}},[e._v(e._s(t.row.openid))])])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"retailer",label:"是否商家",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.retailer?"是":"否"))])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"status",label:"状态",width:"150",sortable:"custom"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(e.statuss[t.row.status]))])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"createTime",label:"注册日期",width:"180",sortable:"custom"}}),e._v(" "),a("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{directives:[{name:"hasPermission",rawName:"v-hasPermission",value:"customer.detail",expression:"'customer.detail'"}],attrs:{size:"small"},on:{click:function(a){e.handleDetail(t.$index,t.row)}}},[e._v("详情")]),e._v(" "),"normal"===t.row.status?a("el-button",{directives:[{name:"hasPermission",rawName:"v-hasPermission",value:"customer.lock",expression:"'customer.lock'"}],attrs:{type:"warning",size:"small"},on:{click:function(a){e.handleLock(t.$index,t.row)}}},[e._v("锁定")]):e._e(),e._v(" "),"locked"===t.row.status?a("el-button",{directives:[{name:"hasPermission",rawName:"v-hasPermission",value:"customer.unlock",expression:"'customer.unlock'"}],attrs:{type:"warning",size:"small"},on:{click:function(a){e.handleUnlock(t.$index,t.row)}}},[e._v("解锁")]):e._e()]}}])})],1),e._v(" "),a("el-col",{staticClass:"toolbar",attrs:{span:24}},[a("el-pagination",{staticStyle:{float:"right"},attrs:{layout:"total, prev, pager, next","page-size":e.pageSize,total:e.total,"prev-text":"上一页","next-text":"下一页",background:""},on:{"current-change":e.handleCurrentChange}})],1)],1):e._e(),e._v(" "),"detail"==e.view?a("div",[a("div",[a("table",[a("tr",[a("td",[a("div",{staticClass:"user_avatar"},[a("img",{directives:[{name:"lazy",rawName:"v-lazy",value:e.customer.avatarUrl,expression:"customer.avatarUrl"}],staticClass:"img_avatar"})])]),e._v(" "),a("td",[a("div",[a("span",{staticClass:"display_name"},[e._v(e._s(e.customer.nickName))]),e._v(" "),a("span",{staticClass:"tips",attrs:{title:e.statuss[e.customer.status]}},[a("i",{class:e.status})])]),e._v(" "),a("div",[a("ul",{staticClass:"user_profile"},[a("li",[a("span",{staticClass:"text_gray"},[e._v("粉龄："),a("span",{staticClass:"tips",attrs:{title:e.createTime}},[e._v(e._s(e.time))])])]),e._v(" "),a("li",[a("span",{staticClass:"text_gray"},[e._v("商家："+e._s(e.customer.retailer?"是":"否"))])])])])])])])]),e._v(" "),a("div",{staticClass:"button-area"},[a("el-button",{attrs:{size:"small"},on:{click:function(t){e.back()}}},[e._v("返回")])],1)]):e._e()])},staticRenderFns:[]};var M=a("VU/8")(I,A,!1,function(e){a("CGYC")},"data-v-fdeae36e",null).exports,H={data:()=>({queryForm:{nickName:"",status:"",share:""},tableData:[],statuss:{normal:"正常",over:"结束"},shares:{0:"否",1:"是"},total:0,pages:0,page:1,pageSize:8,sort:"createTime",order:"desc",message:"",listLoading:!1,view:"list",lottery:{},lotteryPrize:{tableData:[],statuss:{toBeExchange:"未兑奖",exchanged:"已兑奖",expired:"已过期"},total:0,pages:0,page:1,pageSize:4,sort:"createTime",order:"desc",message:"",listLoading:!1}}),methods:{handleCurrentChange(e){this.page=e,this.getTableData()},getTableData(){let e={nickName:this.queryForm.nickName,status:this.queryForm.status,share:""==this.queryForm.share?"":"1"==this.queryForm.share,page:this.page,pageSize:this.pageSize,sort:this.sort,order:this.order};this.listLoading=!0,this.$ajax.get("/lottery/page",e).then(e=>{this.listLoading=!1,e.success?(this.page=e.page,this.pageSize=e.pageSize,this.total=e.total,this.pages=e.pages,this.tableData=e.data):(this.tableData=[],this.page=0,this.total=0,this.pages=0,this.message=e.message)})},handleOver:function(e,t){this.$confirm("确认结束客户【"+t.nickName+"】第"+t.no+"期抽奖吗?","提示",{type:"warning"}).then(()=>{this.listLoading=!0,this.$ajax.post("/lottery/over/"+t.id).then(e=>{this.listLoading=!1,e.success&&(this.$message({message:"已结束",type:"success"}),this.getTableData())})}).catch(()=>{})},handleDetail:function(e,t){this.$ajax.get("/lottery/get/"+t.id).then(e=>{e.success?(this.lottery=e.data,this.getLotteryPrizeTableData(),this.view="detail"):this.$message.error(e.msg)})},sortChanged:function(e){this.sort=e.prop,this.order="ascending"===e.order?"asc":"desc",this.getTableData()},back:function(){this.view="list"},getLotteryPrizeTableData(){let e={lotteryId:this.lottery.id,page:this.lotteryPrize.page,pageSize:this.lotteryPrize.pageSize,sort:this.lotteryPrize.sort,order:this.lotteryPrize.order};this.lotteryPrize.listLoading=!0,this.$ajax.get("/lottery/customer/page",e).then(e=>{this.lotteryPrize.listLoading=!1,e.success?(this.lotteryPrize.page=e.page,this.lotteryPrize.pageSize=e.pageSize,this.lotteryPrize.total=e.total,this.lotteryPrize.pages=e.pages,this.lotteryPrize.tableData=e.data):(this.lotteryPrize.tableData=[],this.lotteryPrize.page=0,this.lotteryPrize.total=0,this.lotteryPrize.pages=0,this.lotteryPrize.message=e.message)})},handleLotteryPrizeCurrentChange(e){this.lotteryPrize.page=e,this.getLotteryPrizeTableData()}}},W={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("section",["list"==e.view?a("div",[a("el-col",{staticClass:"toolbar",staticStyle:{"padding-bottom":"0px"},attrs:{span:24}},[a("el-form",{attrs:{inline:!0,model:e.queryForm}},[a("el-form-item",[a("el-input",{attrs:{placeholder:"客户昵称"},model:{value:e.queryForm.nickName,callback:function(t){e.$set(e.queryForm,"nickName",t)},expression:"queryForm.nickName"}})],1),e._v(" "),a("el-form-item",[a("el-select",{attrs:{placeholder:"请选择抽奖状态",clearable:""},model:{value:e.queryForm.status,callback:function(t){e.$set(e.queryForm,"status",t)},expression:"queryForm.status"}},e._l(e.statuss,function(e,t){return a("el-option",{key:t,attrs:{label:e,value:t}})}))],1),e._v(" "),a("el-form-item",[a("el-select",{attrs:{placeholder:"请选择是否强制分享",clearable:""},model:{value:e.queryForm.share,callback:function(t){e.$set(e.queryForm,"share",t)},expression:"queryForm.share"}},e._l(e.shares,function(e,t){return a("el-option",{key:t,attrs:{label:e,value:t}})}))],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:e.getTableData}},[e._v("查询")])],1)],1)],1),e._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],staticStyle:{width:"100%"},attrs:{data:e.tableData,stripe:"","highlight-current-row":"","default-sort":{prop:"createTime",order:"descending"},"empty-text":e.message},on:{"sort-change":e.sortChanged}},[a("el-table-column",{attrs:{prop:"nickName",label:"客户昵称",width:"250","show-overflow-tooltip":""}}),e._v(" "),a("el-table-column",{attrs:{prop:"no",label:"抽奖期数",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v("第"+e._s(t.row.no)+"期")])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"status",label:"状态",width:"150",sortable:"custom"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-tag",{attrs:{type:"normal"==t.row.status?"success":"danger"}},[e._v(e._s(e.statuss[t.row.status]))])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"createTime",label:"创建日期",width:"180",sortable:"custom"}}),e._v(" "),a("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{directives:[{name:"hasPermission",rawName:"v-hasPermission",value:"lottery.detail",expression:"'lottery.detail'"}],attrs:{size:"small"},on:{click:function(a){e.handleDetail(t.$index,t.row)}}},[e._v("详情")]),e._v(" "),"normal"===t.row.status?a("el-button",{directives:[{name:"hasPermission",rawName:"v-hasPermission",value:"lottery.over",expression:"'lottery.over'"}],attrs:{type:"warning",size:"small"},on:{click:function(a){e.handleOver(t.$index,t.row)}}},[e._v("结束")]):e._e()]}}])})],1),e._v(" "),a("el-col",{staticClass:"toolbar",attrs:{span:24}},[a("el-pagination",{staticStyle:{float:"right"},attrs:{layout:"total, prev, pager, next","page-size":e.pageSize,total:e.total,"prev-text":"上一页","next-text":"下一页",background:""},on:{"current-change":e.handleCurrentChange}})],1)],1):e._e(),e._v(" "),"detail"==e.view?a("div",[a("div",{staticClass:"lottery-detail-box"},[a("div",{staticClass:"lottery-detail-item lottery-detail-basic-box"},[a("div",{staticClass:"lottery-detail-basic-text"},[a("div",{staticClass:"lottery-detail-basic-text-item"},[a("span",{staticClass:"lottery-detail-basic-text-name"},[e._v("第"+e._s(e.lottery.no)+"期")])]),e._v(" "),e.lottery.prizeList.length>0?a("div",{staticClass:"lottery-detail-basic-text-item lottery-detail-prize-box"},[e._l(e.lottery.prizeList,function(t){return[a("div",{key:t.id,staticClass:"lottery-detail-prize"},[a("el-tag",{attrs:{type:"normal"==t.status?"success":"danger"}},[a("div",{staticClass:"lottery-detail-prize-item lottery-detail-prize-name"},[e._v(e._s(t.name))]),e._v(" "),a("div",{staticClass:"lottery-detail-prize-item lottery-detail-prize-number"},[e._v(e._s(t.total-t.quantity)+"("+e._s(t.total)+")")]),e._v(" "),a("div",{staticClass:"lottery-detail-prize-item lottery-detail-prize-number"},[e._v(e._s(t.weight/100)+"%")])])],1)]})],2):e._e(),e._v(" "),e.lottery.prizeList.length>0?a("div",{staticClass:"lottery-detail-basic-text-item"},[a("span",{staticClass:"lottery-detail-basic-text-invalid"},[e._v("*红色为结束奖项，示例：奖项名称 剩余数量(总数量) 中奖概率")])]):e._e()])]),e._v(" "),a("div",{staticClass:"lotteryCustomers"},[a("el-col",{staticClass:"titlebar",attrs:{span:24}},[a("span",{staticClass:"title"},[e._v("中奖明细")]),e._v(" "),a("el-button",{staticClass:"operation",attrs:{size:"small"},on:{click:e.back}},[e._v("返回")])],1),e._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.lotteryPrize.listLoading,expression:"lotteryPrize.listLoading"}],staticStyle:{width:"100%"},attrs:{data:e.lotteryPrize.tableData,stripe:"","highlight-current-row":"","empty-text":e.lotteryPrize.message}},[a("el-table-column",{attrs:{type:"index",width:"60",label:"序号"}}),e._v(" "),a("el-table-column",{attrs:{prop:"name",label:"奖品名称",width:"150","show-overflow-tooltip":""}}),e._v(" "),a("el-table-column",{attrs:{prop:"nickName",label:"中奖客户",width:"200","show-overflow-tooltip":""}}),e._v(" "),a("el-table-column",{attrs:{prop:"status",label:"兑奖状态",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-tag",{attrs:{type:"toBeExchange"==t.row.status?"success":"danger"}},[e._v(e._s(e.lotteryPrize.statuss[t.row.status]))])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"share",label:"分享状态",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-tag",{attrs:{type:t.row.share?"success":"danger"}},[e._v(e._s(t.row.share?"已分享":"未分享"))])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"createTime",label:"中奖时间"}}),e._v(" "),a("el-table-column",{attrs:{prop:"exchangeTime",label:"兑奖时间"}})],1),e._v(" "),a("el-col",{staticClass:"titlebar",attrs:{span:24}},[a("el-pagination",{staticStyle:{float:"right"},attrs:{layout:"total, prev, pager, next","page-size":e.lotteryPrize.pageSize,total:e.lotteryPrize.total,"current-page":e.lotteryPrize.page,"prev-text":"上一页","next-text":"下一页",background:""},on:{"current-change":e.handleLotteryPrizeCurrentChange}})],1)],1)])]):e._e()])},staticRenderFns:[]};var G=a("VU/8")(H,W,!1,function(e){a("wAFG")},"data-v-0042da81",null).exports,J={data:()=>({queryForm:{propertyDesc:"",propertyName:""},tableData:[],total:0,pages:0,page:1,pageSize:8,message:"",listLoading:!1,editFormVisible:!1,editLoading:!1,editFormRules:{propertyName:[{required:!0,message:"请输入参数名称",trigger:"blur"}],propertyValue:[{required:!0,message:"请输入参数值",trigger:"blur"}]},editForm:{id:"",propertyName:"",propertyValue:"",propertyDesc:""},addFormVisible:!1,addLoading:!1,addFormRules:{propertyName:[{required:!0,message:"请输入参数名称",trigger:"blur"}],propertyValue:[{required:!0,message:"请输入参数值",trigger:"blur"}]},addForm:{propertyName:"",propertyValue:"",propertyDesc:""}}),methods:{handleCurrentChange(e){this.page=e,this.getTableData()},getTableData(){let e={propertyDesc:this.queryForm.propertyDesc,propertyName:this.queryForm.propertyName,page:this.page,pageSize:this.pageSize};this.listLoading=!0,this.$ajax.get("/system/config/page",e).then(e=>{this.listLoading=!1,e.success?(this.page=e.page,this.pageSize=e.pageSize,this.total=e.total,this.pages=e.pages,this.tableData=e.data):(this.tableData=[],this.page=0,this.total=0,this.pages=0,this.message=e.message)})},handleAdd:function(){this.addForm={propertyName:"",propertyValue:"",propertyDesc:""},this.addFormVisible=!0},handleEdit:function(e,t){this.editForm=Object.assign({},t),this.editFormVisible=!0},editSubmit:function(){this.$refs.editForm.validate(e=>{e&&this.$confirm("确认提交吗？","提示",{}).then(()=>{this.editLoading=!0;let e=Object.assign({},this.editForm);this.$ajax.post("/system/config/update",e).then(e=>{this.editLoading=!1,e.success&&(this.$message({message:"提交成功",type:"success"}),this.$refs.editForm.resetFields(),this.editFormVisible=!1,this.getTableData())})})})},addSubmit:function(){this.$refs.addForm.validate(e=>{e&&this.$confirm("确认提交吗？","提示",{}).then(()=>{this.addLoading=!0;let e=Object.assign({},this.addForm);this.$ajax.post("/system/config/add",e).then(e=>{this.addLoading=!1,e.success&&(this.$message({message:"提交成功",type:"success"}),this.$refs.addForm.resetFields(),this.addFormVisible=!1,this.getTableData())})})})},handleDel:function(e,t){this.$confirm("确认删除该记录吗?","提示",{type:"warning"}).then(()=>{this.listLoading=!0,this.$ajax.post("/system/config/delete/"+t.id).then(e=>{this.listLoading=!1,e.success&&(this.$message({message:"删除成功",type:"success"}),this.getTableData())})}).catch(()=>{})}},created(){this.getTableData()}},K={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("section",[a("el-col",{staticClass:"toolbar",staticStyle:{"padding-bottom":"0px"},attrs:{span:24}},[a("el-form",{attrs:{inline:!0,model:e.queryForm}},[a("el-form-item",[a("el-input",{attrs:{placeholder:"关键字"},model:{value:e.queryForm.propertyDesc,callback:function(t){e.$set(e.queryForm,"propertyDesc",t)},expression:"queryForm.propertyDesc"}})],1),e._v(" "),a("el-form-item",[a("el-input",{attrs:{placeholder:"参数名称"},model:{value:e.queryForm.propertyName,callback:function(t){e.$set(e.queryForm,"propertyName",t)},expression:"queryForm.propertyName"}})],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:e.getTableData}},[e._v("查询")])],1),e._v(" "),a("el-form-item",[a("el-button",{directives:[{name:"hasPermission",rawName:"v-hasPermission",value:"system.config.add",expression:"'system.config.add'"}],attrs:{type:"primary"},on:{click:e.handleAdd}},[e._v("新增")])],1)],1)],1),e._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],staticStyle:{width:"100%"},attrs:{data:e.tableData,stripe:"","highlight-current-row":"","empty-text":e.message}},[a("el-table-column",{attrs:{type:"index",width:"60",label:"序号"}}),e._v(" "),a("el-table-column",{attrs:{prop:"propertyName",label:"参数名称",width:"250","show-overflow-tooltip":""}}),e._v(" "),a("el-table-column",{attrs:{prop:"propertyValue",label:"参数值",width:"300","show-overflow-tooltip":""}}),e._v(" "),a("el-table-column",{attrs:{prop:"propertyDesc",label:"参数描述","show-overflow-tooltip":""}}),e._v(" "),a("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{directives:[{name:"hasPermission",rawName:"v-hasPermission",value:"system.config.edit",expression:"'system.config.edit'"}],attrs:{size:"small"},on:{click:function(a){e.handleEdit(t.$index,t.row)}}},[e._v("编辑")]),e._v(" "),a("el-button",{directives:[{name:"hasPermission",rawName:"v-hasPermission",value:"system.config.delete",expression:"'system.config.delete'"}],attrs:{type:"danger",size:"small"},on:{click:function(a){e.handleDel(t.$index,t.row)}}},[e._v("删除")])]}}])})],1),e._v(" "),a("el-col",{staticClass:"toolbar",attrs:{span:24}},[a("el-pagination",{staticStyle:{float:"right"},attrs:{layout:"total, prev, pager, next","page-size":e.pageSize,total:e.total,"prev-text":"上一页","next-text":"下一页",background:""},on:{"current-change":e.handleCurrentChange}})],1),e._v(" "),a("el-dialog",{attrs:{title:"编辑",visible:e.editFormVisible,"close-on-click-modal":!1},on:{"update:visible":function(t){e.editFormVisible=t}}},[a("el-form",{ref:"editForm",attrs:{model:e.editForm,"label-width":"80px",rules:e.editFormRules}},[a("el-form-item",{attrs:{label:"参数名称",prop:"propertyName"}},[a("el-input",{attrs:{"auto-complete":"off"},model:{value:e.editForm.propertyName,callback:function(t){e.$set(e.editForm,"propertyName",t)},expression:"editForm.propertyName"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"参数值",prop:"propertyValue"}},[a("el-input",{attrs:{"auto-complete":"off"},model:{value:e.editForm.propertyValue,callback:function(t){e.$set(e.editForm,"propertyValue",t)},expression:"editForm.propertyValue"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"参数描述",prop:"propertyDesc"}},[a("el-input",{attrs:{"auto-complete":"off"},model:{value:e.editForm.propertyDesc,callback:function(t){e.$set(e.editForm,"propertyDesc",t)},expression:"editForm.propertyDesc"}})],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{nativeOn:{click:function(t){e.editFormVisible=!1}}},[e._v("取消")]),e._v(" "),a("el-button",{attrs:{type:"primary",loading:e.editLoading},nativeOn:{click:function(t){return e.editSubmit(t)}}},[e._v("提交")])],1)],1),e._v(" "),a("el-dialog",{attrs:{title:"新增",visible:e.addFormVisible,"close-on-click-modal":!1},on:{"update:visible":function(t){e.addFormVisible=t}}},[a("el-form",{ref:"addForm",attrs:{model:e.addForm,"label-width":"80px",rules:e.addFormRules}},[a("el-form-item",{attrs:{label:"参数名称",prop:"propertyName"}},[a("el-input",{attrs:{"auto-complete":"off"},model:{value:e.addForm.propertyName,callback:function(t){e.$set(e.addForm,"propertyName",t)},expression:"addForm.propertyName"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"参数值",prop:"propertyValue"}},[a("el-input",{attrs:{"auto-complete":"off"},model:{value:e.addForm.propertyValue,callback:function(t){e.$set(e.addForm,"propertyValue",t)},expression:"addForm.propertyValue"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"参数描述",prop:"propertyDesc"}},[a("el-input",{attrs:{"auto-complete":"off"},model:{value:e.addForm.propertyDesc,callback:function(t){e.$set(e.addForm,"propertyDesc",t)},expression:"addForm.propertyDesc"}})],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{nativeOn:{click:function(t){e.addFormVisible=!1}}},[e._v("取消")]),e._v(" "),a("el-button",{attrs:{type:"primary",loading:e.addLoading},nativeOn:{click:function(t){return e.addSubmit(t)}}},[e._v("提交")])],1)],1)],1)},staticRenderFns:[]},Y=a("VU/8")(J,K,!1,null,null,null).exports;s.default.use(o.a);var B=new o.a({mode:"history",routes:[{path:"/",redirect:"/login",meta:{isMenu:!1}},{path:"/login",name:"login",component:m,meta:{title:"登录",isMenu:!1}},{path:"/expired",name:"expired",component:h,meta:{title:"会话过期",isMenu:!1}},{path:"/unauth",name:"unauth",component:v,meta:{title:"无权限",isMenu:!1}},{path:"/admin",redirect:"/index",meta:{title:"布局",isMenu:!1,isLogin:!0}},{path:"/home",name:"admin",redirect:"/index",component:u,meta:{title:"首页",isMenu:!0,isLeaf:!0,isLogin:!0},children:[{path:"/index",name:"index",component:y,meta:{title:"首页",isMenu:!1,isLogin:!0}}]},{path:"/system",name:"system",component:u,meta:{title:"系统管理",isMenu:!0,isLeaf:!1,permission:"system.user|system.role|system.auth|system.log|system.interface|system.config"},children:[{path:"/system/user",name:"user",component:w,meta:{title:"人员管理",isMenu:!0,isLeaf:!0,permission:"system.user"}},{path:"/system/role",name:"role",component:z,meta:{title:"角色管理",isMenu:!0,isLeaf:!0,permission:"system.role"}},{path:"/system/auth",name:"auth",component:N,meta:{title:"权限管理",isMenu:!0,isLeaf:!0,permission:"system.auth"}},{path:"/system/log",name:"log",component:D,meta:{title:"系统日志",isMenu:!0,isLeaf:!0,permission:"system.log"}},{path:"/system/interface",name:"interface",component:E,meta:{title:"接口调用",isMenu:!0,isLeaf:!0,permission:"system.interface"}},{path:"/system/config",name:"config",component:Y,meta:{title:"系统参数",isMenu:!0,isLeaf:!0,permission:"system.config"}}]},{path:"/carousel",name:"carousel",redirect:"/carousel/index",component:u,meta:{title:"轮播管理",isMenu:!0,isLeaf:!0,isLogin:!0,permission:"carousel"},children:[{path:"/carousel/index",name:"carouselPage",component:U,meta:{title:"轮播管理",isMenu:!1,isLeaf:!0,permission:"carousel"}}]},{path:"/customer",name:"customer",redirect:"/customer/index",component:u,meta:{title:"客户管理",isMenu:!0,isLeaf:!0,isLogin:!0,permission:"customer"},children:[{path:"/customer/index",name:"customerPage",component:M,meta:{title:"客户管理",isMenu:!1,isLeaf:!0,permission:"customer"}}]},{path:"/lottery",name:"lottery",redirect:"/lottery/index",component:u,meta:{title:"抽奖管理",isMenu:!0,isLeaf:!0,isLogin:!0,permission:"lottery"},children:[{path:"/lottery/index",name:"lotteryPage",component:G,meta:{title:"抽奖管理",isMenu:!1,isLeaf:!0,permission:"lottery"}}]},{path:"/setting",name:"setting",redirect:"/system/setting",component:u,meta:{title:"个人设置",isMenu:!1,isLogin:!0,permission:"system.setting"},children:[{path:"/system/setting",name:"SettingIndex",component:q,meta:{title:"个人设置",isMenu:!1,isLogin:!0}}]}]}),X=a("zL8q"),Z=a.n(X),Q=(a("tvR6"),a("NYxO"));s.default.use(Q.a);var ee=new Q.a.Store({state:{isLogin:!1,user:null,permissions:[],key:""},mutations:{login(e){e.isLogin=!0,sessionStorage.setItem("isLogin","true")},logout(e){e.isLogin=!1,e.user=null,e.permissions=[],sessionStorage.clear()},setUser(e,t){e.user=t,sessionStorage.setItem("user",JSON.stringify(t))},setPermissions(e,t){e.permissions=t,sessionStorage.setItem("permissions",JSON.stringify(t))},setKey(e,t){e.key=t,sessionStorage.setItem("key",t)}},getters:{logined:function(e){return e.isLogin||"true"==sessionStorage.getItem("isLogin")&&(e.isLogin=!0),e.isLogin},getUser:function(e){return null==e.user&&(e.user=JSON.parse(sessionStorage.getItem("user"))),e.user},getPermissions:function(e){return e.permissions==[]&&(e.permissions=JSON.parse(sessionStorage.getItem("permissions"))),e.permissions},getKey:function(e){return""==e.key&&(e.key=sessionStorage.getItem("key")),e.key}}}),te=(a("e0XP"),a("cTzj")),ae=a.n(te),se=a("mtWM"),ie=a.n(se),re=a("wO61");function oe(e){return{}.toString.call(e).match(/\s([a-zA-Z]+)/)[1].toLowerCase()}function le(e,t,a){return a&&(a=function e(t){for(var a in t)null===t[a]&&delete t[a],"string"===oe(t[a])?t[a]=t[a].trim():"object"===oe(t[a])?t[a]=e(t[a]):"array"===oe(t[a])&&(t[a]=e(t[a]));return t}(a)),new Promise(function(s,i){ie()({method:e,url:t,data:"POST"===e||"PUT"===e?a:null,params:"GET"===e||"DELETE"===e?a:null}).then(function(e){200===e.status?(e.data.success||("没有权限"===e.data.message?B.push({path:"/unauth"}):"没有登陆或session已过期"===e.data.message&&B.push({path:"/expired"})),s(e.data)):i(e)},function(e){Object(re.a)({message:"网络错误，请稍后再试",type:"error"})})})}ie.a.defaults.baseURL="https://api.assistance.ccyws.cn",ie.a.defaults.timeout=6e4,ie.a.defaults.maxRedirects=2,ie.a.defaults.withCredentials=!0;var ne={get:function(e,t){return le("GET",e,t)},post:function(e,t,a,s){return le("POST",e,t).then(function(e){return e.success||Object(re.a)({message:e.message,type:"error"}),Promise.resolve(e)})},serviceUrl:ie.a.defaults.baseURL,imageServiceUrl:"https://file.ccyws.cn"},me=a("Av7u"),de=a.n(me),ce=a("4C6m"),ue=a.n(ce),pe={random:function(e){let t="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";var a="";let s=0;for(;s<e;){a+=t[Math.floor(Math.random()*t.length)],s++}return a},encrypt:function(e,t){return de.a.enc.Base64.stringify(de.a.DES.encrypt(e,de.a.enc.Utf8.parse(t),{mode:de.a.mode.CBC,padding:de.a.pad.Pkcs7,iv:de.a.enc.Utf8.parse(t)}).ciphertext)},rsaEncrypt:function(e,t){let a=new ue.a;return a.setPublicKey(t),a.encrypt(e)}};s.default.use(Z.a),s.default.use(ae.a,{attempt:10}),s.default.config.productionTip=!1,s.default.prototype.$ajax=ne,s.default.prototype.$service=ne.serviceUrl,s.default.prototype.$imageService=ne.imageServiceUrl,s.default.prototype.$util=pe,s.default.directive("hasPermission",{bind:function(e,t,a){let s=JSON.parse(sessionStorage.getItem("permissions"));var i=!0;if(void 0==t.value||""==t.value)i=!1;else if(s&&s.length){var r,o=t.value.split("|");for(r in o)if(s.includes(o[r])){i=!1;break}}i&&e.parentNode.removeChild(e)}}),s.default.prototype.$contains=function(e,t){if(null==e)return!1;for(var a=0;a<e.length;a++)if(e[a]===t)return!0;return!1},B.beforeEach((e,t,a)=>{e.meta.hasOwnProperty("isLogin")&&e.meta.isLogin||e.meta.hasOwnProperty("permission")?"true"==sessionStorage.isLogin?a():a("login"):a()}),new s.default({el:"#app",router:B,store:ee,components:{App:r},template:"<App/>"})},NTCn:function(e,t){},cyca:function(e,t){},d0mW:function(e,t){},dSTW:function(e,t){},e0XP:function(e,t){},gCNA:function(e,t){},ih9G:function(e,t){},kH9v:function(e,t){},"sAI+":function(e,t,a){"use strict";const s={success:"success",info:"info",warning:"warning",error:"error"};var i={data:()=>({visible:!1,message:"",duration:3e3,type:"info",iconClass:"",customClass:"",onClose:null,showClose:!1,closed:!1,timer:null,dangerouslyUseHTMLString:!1,center:!1}),computed:{iconWrapClass(){const e=["el-message__icon"];return this.type&&!this.iconClass&&e.push(`el-message__icon--${this.type}`),e},typeClass(){return this.type&&!this.iconClass?`el-message__icon el-icon-${s[this.type]}`:""}},watch:{closed(e){e&&(this.visible=!1,this.$el.addEventListener("transitionend",this.destroyElement))}},methods:{destroyElement(){this.$el.removeEventListener("transitionend",this.destroyElement),this.$destroy(!0),this.$el.parentNode.removeChild(this.$el)},close(){this.closed=!0,"function"==typeof this.onClose&&this.onClose(this)},clearTimer(){clearTimeout(this.timer)},startTimer(){this.duration>0&&(this.timer=setTimeout(()=>{this.closed||this.close()},this.duration))},keydown(e){27===e.keyCode&&(this.closed||this.close())}},mounted(){this.startTimer(),document.addEventListener("keydown",this.keydown)},beforeDestroy(){document.removeEventListener("keydown",this.keydown)}},r={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("transition",{attrs:{name:"el-message-fade"}},[a("div",{directives:[{name:"show",rawName:"v-show",value:e.visible,expression:"visible"}],class:["el-message",e.type&&!e.iconClass?"el-message--"+e.type:"",e.center?"is-center":"",e.showClose?"is-closable":"",e.customClass],attrs:{role:"alert"},on:{mouseenter:e.clearTimer,mouseleave:e.startTimer}},[e.iconClass?a("i",{class:e.iconClass}):a("i",{class:e.typeClass}),e._v(" "),e._t("default",[e.dangerouslyUseHTMLString?a("p",{staticClass:"el-message__content",domProps:{innerHTML:e._s(e.message)}}):a("p",{staticClass:"el-message__content"},[e._v(e._s(e.message))])]),e._v(" "),e.showClose?a("i",{staticClass:"el-message__closeBtn el-icon-close",on:{click:e.close}}):e._e()],2)])},staticRenderFns:[]},o=a("VU/8")(i,r,!1,null,null,null);t.a=o.exports},t5Ou:function(e,t){},tvR6:function(e,t){},wAFG:function(e,t){},zNWp:function(e,t){}},["NHnr"]);
//# sourceMappingURL=app.8bf3707d0b72a7bba2af.js.map